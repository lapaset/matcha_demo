{"version":3,"sources":["utils/auth.js","services/userService.js","services/notificationService.js","services/likeService.js","services/chatService.js","socket/index.js","services/photoService.js","components/UserProfile/UserPhotos/UploadPhoto.js","components/UserProfile/UserPhotos/UploadModal.js","components/UserProfile/UserPhotos/EmptyBox.js","components/UserProfile/UserPhotos/ProfilePicButton.js","components/UserProfile/UserPhotos/DeletePhotoButton.js","components/UserProfile/UserPhotos/PhotoBox.js","components/UserProfile/UserPhotos/index.js","components/UI/Forms/RequiredInputField.js","components/UI/Forms/PasswordFields.js","components/UI/Forms/SelectGender.js","components/UI/Forms/SelectOrientation.js","services/tagService.js","components/UI/Forms/SelectTags.js","components/UI/Forms/BioTextArea.js","utils/dbFunctions.js","components/UserProfile/UpdateUserForm/index.js","components/UserProfile/Map/index.js","services/visitService.js","components/UserProfile/VisitHistory/index.js","services/blockService.js","components/UserProfile/BlockList/index.js","components/UI/Togglable.js","components/UserProfile/index.js","components/Signup/BirthdateField.js","components/Signup/index.js","services/loginService.js","components/Login/index.js","modules/geolocate.js","components/Verify/index.js","services/forgotpassService.js","components/ForgotPassword/index.js","components/ForgotPassword/resetNewPasswd.js","components/UserBrowser/UserCard/Photos.js","components/UserBrowser/UserCard/ActionButtons.js","components/UserBrowser/UserCard/UserInformation.js","components/UserBrowser/UserCard/MatchModal.js","components/UserBrowser/UserCard/CardHeader.js","components/UserBrowser/UserCard/ConfirmationModal.js","services/reportService.js","components/UserBrowser/UserCard/index.js","hooks/index.js","components/UserBrowser/ListOfUsers.js","components/UserBrowser/UserSearch/SortForm.js","components/UserBrowser/UserSearch/FilterForm.js","components/UserBrowser/UserSearch/index.js","components/UserBrowser/UserLikes.js","components/UserBrowser/UserViews.js","components/UserBrowser/index.js","components/Matches/Chat/index.js","components/Matches/index.js","components/Notifications/Notification.js","components/Notifications/index.js","services/logoutService.js","components/UserView/Navigation.js","components/UserView/UserInfoForm/UploadFirstPhoto.js","components/UserView/UserInfoForm/index.js","components/Notifications/NotificationsList.js","components/UserView/index.js","App.js","index.js"],"names":["token","newToken","headers","Authorization","baseUrl","orientationFromDb","orientation","o","includes","push","getAll","a","axios","get","auth","resp","data","map","u","getUser","userId","first_name","last_name","id","profile_pic","photo_str","user","undefined","photos","r","photoStr","profilePic","firstName","lastName","age","years","updateUser","userObject","patch","createUser","post","getByGenderOrientation","gender","genderStr","substring","join","getNotifications","user_id","notify","notification","markAsRead","read","markAllAsRead","getLikes","getLikesToUser","getLike","to_user_id","getMatches","toggleLike","getChatHistory","from","client","W3CWebSocket","onerror","console","log","onopen","send","JSON","stringify","type","onclose","wsClient","current","readyState","addPhoto","photo","deletePhoto","delete","toggleProfilePhoto","put","UploadPhoto","setPhoto","setUploadDisabled","useState","errorMessage","setErrorMessage","Form","className","ResponsiveEmbed","aspectRatio","Image","src","alt","title","style","maxWidth","maxHeight","Group","Label","htmlFor","Control","accept","onChange","e","preventDefault","reader","FileReader","file","target","files","size","onloadend","result","readAsDataURL","UploadModal","setUser","showModal","closeModal","uploadDisabled","Modal","show","onHide","Header","closeButton","Title","Body","length","Footer","Button","variant","onClick","photoService","then","newPhoto","updatedUser","concat","catch","disabled","EmptyBox","setShowModal","position","bottom","right","icon","faPlus","ProfilePicButton","faUser","color","p","DeletePhotoButton","newProfilePic","find","filter","faTrash","PhotoBox","hovered","setHovered","imgStyle","buttonStyle","display","onMouseEnter","onMouseLeave","username","ButtonGroup","UserPhotos","setProfilePic","emptyPhotos","useEffect","Container","Row","noGutters","Col","xs","key","Array","i","RequiredInputField","label","errors","name","defVal","maxLen","requirements","register","message","defaultValue","maxLength","ref","required","value","PasswordFields","watch","password","useRef","placeholder","minLength","pattern","validate","password2","SelectGender","control","class","as","Select","options","rules","SelectOrientation","isMulti","getTags","addTag","tagObject","SelectTags","state","setState","setOptions","createOption","tagService","t","tag","error","inputValue","isClearable","onInputChange","onKeyDown","event","newTag","startsWith","BioTextArea","bio","selected","v","tags","split","slice","UpdateUserForm","setNotification","dbFunctions","userTagsState","setUserTagsState","useForm","handleSubmit","reset","onSubmit","userService","response","email","Map","lat","lng","setMapCentre","latitude","longitude","addVisit","visitHistory","to","VisitHistory","setVisitHistory","visitService","res","ListGroup","Item","action","date","live","block","getAllBlocked","getBlockedId","getBlockedByUser","unblockUser","BlockList","blockedUsers","setBlockedUsers","blockService","from_user_id","width","textAlign","block_id","Togglable","props","visible","setVisible","showWhenVisible","cursor","hideText","showText","children","UserProfile","BirthdateField","day","month","valueMissing","year","Date","getDate","isValidDate","Signup","rand","Math","random","toString","substr","birthdate","login","credentials","Login","setUsername","setPassword","navigator","geolocation","getCurrentPosition","coords","localStorage","setItem","parse","window","getItem","loginService","sessionToken","socket","Verify","forgotPass","resetPass","newpass","ForgotPassword","setEmail","setMessage","errMessage","setErrmessage","forgotPasswdService","ResetPassword","cpassword","setCpassword","status","setStatus","errmsg","setErrmsg","useParams","resetPassService","SelectorIcon","handleClick","Card","Link","href","faCircle","PhotoSelector","selectedPhoto","setSelectedPhoto","changePhoto","Photos","photoSelectorProps","Img","DisabledLikeButton","OverlayTrigger","overlay","Tooltip","faHeart","LikeButton","text","ActionButton","setConfirmationModal","ActionButtons","liked","hasPhoto","likeHandler","reportHandler","blockHandler","actionButtonProps","faFlag","faBan","UserInformation","isMatch","Text","ListGroupItem","online","last_online","MatchModal","modal","setModal","centered","CardHeader","hideUser","fame","faAward","ConfirmationModal","m","report","UserCard","loggedUser","matches","setMatches","setLiked","matchModal","setMatchModal","confirmationModal","userToShow","setUserToShow","from_id","likeService","sendNotification","match","messages","reportService","location","useFilter","setValue","val","parseInt","Tags","ListOfUsers","users","distance","SortForm","resultsToShow","setResultsToShow","sortResults","useCallback","by","countMutualTags","userTags","reduce","sortedResults","sort","b","mutualTags","defaultSortValue","FilterForm","requiredTags","handleTagsChange","maxDistance","minFame","minAge","maxAge","UserSearch","showUser","setRequiredTags","matchesFilters","every","sortFormProps","filterFormProps","UserLikes","some","l","UserViews","UserBrowser","showUserAtLoad","setUsers","useRouteMatch","path","url","history","useHistory","usersFromDb","activeLinkStyle","fontWeight","userCardProps","userSearchProps","userLikesProps","userViewsProps","exact","activeStyle","render","Chat","handleClose","input","setInput","messagesEndRef","inputField","scrollIntoView","behavior","onEntered","focus","height","overflowY","paddingBottom","marginLeft","sender","msg","fromUn","InputGroup","Append","LatestMsgPreview","latestReceived","receiver","faReply","Matches","chatToShow","setChatToShow","Notification","Notifications","notifications","handleNotificationClick","markAllNotificationsRead","NavDropdown","faBell","n","alignRight","Divider","clear","NavigationLink","Nav","NavLink","Navigation","userInfoComplete","notificationProps","Navbar","fixed","faComments","logoutService","faSignOutAlt","UploadFirstPhoto","UserInfoForm","photoToAdd","addedPhoto","newUser","NotificationsList","UserView","setNotifications","useLocation","notificationService","endsWith","matchProps","navigationProps","userInfoFormProps","fluid","search","indexOf","Number","component","Forgot","Reset","App","loadingUser","loggedUserJSON","userFromLocalStorage","matchesFromDb","chatService","forEach","onmessage","dataFromServer","updatedMatches","newMatch","updatedNotifications","unshift","ReactDOM","document","getElementById"],"mappings":"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","file":"static/js/main.de896d75.chunk.js","sourcesContent":["let token = null\n\nconst setToken = newToken => {\n\ttoken = `bearer ${newToken}`\n}\n\nconst config = () => ({\n\theaders: { Authorization: token },\n})\n\nexport default { setToken, config }","import axios from 'axios'\nimport auth from '../utils/auth'\nconst baseUrl = '/api/users'\n\nconst orientationFromDb = orientation => {\n\tconst o = []\n\n\tif (!orientation)\n\t\treturn o\n\tif (orientation.includes('f'))\n\t\to.push('female')\n\tif (orientation.includes('m'))\n\t\to.push('male')\n\tif (orientation.includes('o'))\n\t\to.push('other')\n\treturn o\n}\n\nconst getAll = async () => {\n\tconst resp = await axios.get(baseUrl, auth.config())\n\n\treturn resp.data.map(u => ({\n\t\t...u,\n\t\torientation: orientationFromDb(u.orientation)\n\t}))\n}\n\nconst getUser = async userId => {\n\tif (!userId)\n\t\treturn\n\n\tconst resp = await axios.get(`${baseUrl}/${userId}`, auth.config())\n\n\tif (!resp.data[0])\n\t\treturn resp.data\n\n\t// eslint-disable-next-line no-unused-vars\n\tconst { first_name, last_name, id, profile_pic, photo_str, orientation, ...user } = resp.data[0]\n\n\tif (resp.data[0].id && resp.data[0].profile_pic !== undefined && resp.data[0].photo_str) {\n\n\t\tuser.photos = resp.data.map(r => {\n\t\t\treturn ({ id: r.id, photoStr: r.photo_str, profilePic: r.profile_pic })\n\t\t})\n\t}\n\n\treturn ({\n\t\t...user,\n\t\tfirstName: first_name,\n\t\tlastName: last_name,\n\t\torientation: orientationFromDb(orientation),\n\t\tage: resp.data[0].age.years\n\t})\n}\n\nconst updateUser = async (userObject, id) => {\n\n\tconst resp = await axios.patch(`${baseUrl}/${id}`, userObject, auth.config())\n\n\tif (resp.data.first_name) {\n\t\tlet { first_name, ...userObject } = resp.data\n\t\tuserObject.firstName = first_name\n\t}\n\n\tif (resp.data.last_name) {\n\t\tlet { last_name, ...userObject } = resp.data\n\t\tuserObject.lastName = last_name\n\t}\n\n\tif (resp.data.orientation)\n\t\tuserObject.orientation = orientationFromDb(resp.data.orientation)\n\n\treturn userObject\n}\n\nconst createUser = async userObject => {\n\tconst resp = await axios.post(baseUrl, userObject)\n\treturn resp.data\n}\n\nconst getByGenderOrientation = async (gender, orientation) => {\n\tconst genderStr = gender.map(o => o.substring(0,1)).join('')\n\tconst resp = await axios\n\t\t.get(`${baseUrl}?gender=${genderStr}&orientation=${orientation.substring(0,1)}`, auth.config())\n\treturn resp.data\n}\n\nexport default { getAll, getUser, updateUser, createUser, getByGenderOrientation }","import axios from 'axios'\nimport auth from '../utils/auth'\nconst baseUrl = '/api/notifications'\n\nconst getNotifications = async user_id => {\n\tconst resp = await axios.get(`${baseUrl}?user_id=${user_id}`, auth.config())\n\treturn resp.data\n}\n\nconst notify = async notification => {\n\tconst resp = await axios.post(baseUrl, notification, auth.config())\n\treturn resp.data\n}\n\nconst markAsRead = async id => {\n\tconst resp = await axios.patch(`${baseUrl}/${id}`, { read: 1 }, auth.config())\n\treturn resp.data\n}\n\nconst markAllAsRead = async () => {\n\tconst resp = await axios.patch(`${baseUrl}`, { read: 1 }, auth.config())\n\treturn resp.data\n}\n\nexport default { getNotifications, notify, markAsRead, markAllAsRead }","import axios from 'axios'\nimport auth from '../utils/auth'\nconst baseUrl = '/api/likes'\n\nconst getLikes = async () => {\n\tconst resp = await axios.get(`${baseUrl}`, auth.config())\n\treturn resp.data\n}\n\nconst getLikesToUser = async () => {\n\tconst resp = await axios.get(`${baseUrl}?to=true`, auth.config())\n\treturn resp.data\n}\n\nconst getLike = async to_user_id => {\n\tconst resp = await axios.get(`${baseUrl}?to_user_id=${to_user_id}`, auth.config())\n\treturn resp.data\n}\n\nconst getMatches = async () => {\n\tconst resp = await axios.get(`${baseUrl}?match=1`, auth.config())\n\treturn resp.data\n}\n\nconst toggleLike = async user_id => {\n\tconst resp = await axios.post(baseUrl, { to_user_id: user_id }, auth.config())\n\treturn resp.data\n}\n\nexport default { getLikes, getLikesToUser, getLike, getMatches, toggleLike }","import axios from 'axios'\nimport auth from '../utils/auth'\n\nconst baseUrl = '/api/chat'\n\nconst getChatHistory = async () => {\n\tconst resp = await axios.get(`${baseUrl}`, auth.config())\n\treturn resp.data\n}\n\nexport default { getChatHistory }","import { w3cwebsocket as W3CWebSocket } from 'websocket'\n\nconst createWs = from => {\n\tconst client = new W3CWebSocket('ws://127.0.0.1:3001')\n\n\tclient.onerror = () => {\n\t\tconsole.log('Websocket connection error')\n\t}\n\n\tclient.onopen = () => {\n\n\t\tconsole.log('Websocket client connected')\n\t\tclient.send(JSON.stringify({\n\t\t\ttype: 'connected',\n\t\t\tfrom\n\t\t}))\n\t}\n\n\tclient.onclose = () => {\n\t\tconsole.log('Websocket connection closed')\n\t\tclient.send(JSON.stringify({\n\t\t\ttype: 'closed',\n\t\t\tfrom\n\t\t}))\n\t}\n\n\treturn client\n}\n\nconst sendNotification = (wsClient, notification) => {\n\n\t//console.log('socket.sendNotification', notification)\n\t//show some kind of error if connection is not working\n\tif (!wsClient.current) {\n\t\tconsole.log('Error: could not send notification, no websocket')\n\t\treturn\n\t}\n\n\tif (wsClient.current.readyState > 1) {\n\t\tconsole.log('Error: could not send notification, websocket state', wsClient.current.readyState)\n\t\treturn\n\t}\n\n\twsClient.current.send(JSON.stringify({\n\t\t...notification,\n\t\ttype: 'notification'\n\t}))\n\n}\n\nexport default { createWs, sendNotification }","import axios from 'axios'\nimport auth from '../utils/auth'\nconst baseUrl = '/api/photos'\n\nconst addPhoto = async photo => {\n\tconst resp = await axios.post(baseUrl, photo, auth.config())\n\treturn resp.data\n}\n\nconst deletePhoto = async id => {\n\tawait axios.delete(`${baseUrl}/${id}`, auth.config())\n}\n\nconst toggleProfilePhoto = async (id, profilePic) => {\n\tconst resp = await axios.put(`${baseUrl}/${id}`, { profilePic: profilePic }, auth.config())\n\treturn resp.data\n}\n\nexport default { addPhoto, deletePhoto, toggleProfilePhoto }","import React, { useState } from 'react'\nimport { Form, Image, ResponsiveEmbed } from 'react-bootstrap'\n\nconst UploadPhoto = ({ photo, setPhoto, profilePic, setUploadDisabled }) => {\n\tconst [errorMessage, setErrorMessage] = useState(null)\n\n\tconst handleImageChange = e => {\n\t\te.preventDefault()\n\n\t\tlet reader = new FileReader()\n\t\tlet file = e.target.files[0]\n\n\t\tif (!file)\n\t\t\treturn\n\n\t\tif (file.size > 350000) {\n\t\t\tsetErrorMessage('Max photo size is 350kb')\n\t\t\tif (!photo)\n\t\t\t\tsetUploadDisabled(true)\n\t\t\treturn\n\t\t}\n\n\t\treader.onloadend = () => {\n\t\t\tsetPhoto({\n\t\t\t\tphotoStr: reader.result,\n\t\t\t\tprofilePic\n\t\t\t})\n\t\t}\n\t\treader.readAsDataURL(file)\n\t\tsetUploadDisabled(false)\n\t\tsetErrorMessage('')\n\t}\n\n\tconst imagePreview = () => photo.photoStr\n\t\t? <ResponsiveEmbed aspectRatio=\"1by1\">\n\t\t\t<div className=\"border d-flex\" >\n\t\t\t\t<Image src={photo.photoStr} alt=\"upload preview\" title=\"upload preview\"\n\t\t\t\t\tclassName=\"img-fluid d-block m-auto\" style={{ maxWidth: '100%', maxHeight: '100%' }} />\n\t\t\t</div>\n\t\t</ResponsiveEmbed>\n\t\t: null\n\n\treturn <>\n\t\t<Form className=\"text-center\">\n\n\t\t\t{imagePreview()}\n\n\t\t\t<Form.Group>\n\t\t\t\t<Form.Label htmlFor=\"upload\" className=\"btn btn-primary mt-3\">Choose photo</Form.Label>\n\t\t\t\t<Form.Control id=\"upload\" type=\"file\"\n\t\t\t\t\taccept=\".png, .jpg, .jpeg\" onChange={handleImageChange} />\n\t\t\t</Form.Group>\n\t\t\t{errorMessage && <div className=\"text-center text-danger\" >{errorMessage}</div>}\n\t\t</Form>\n\t</>\n}\n\nexport default UploadPhoto","import React, { useState } from 'react'\nimport { Modal, Button } from 'react-bootstrap'\nimport photoService from '../../../services/photoService'\nimport UploadPhoto from './UploadPhoto'\n\nconst UploadModal = ({ user, setUser, showModal, closeModal }) => {\n\n\tconst [photo, setPhoto] = useState({})\n\tconst [uploadDisabled, setUploadDisabled] = useState(true)\n\n\tconst handleUpload = e => {\n\t\te.preventDefault()\n\n\t\tphotoService\n\t\t\t.addPhoto({\n\t\t\t\tuser_id: user.user_id,\n\t\t\t\t...photo\n\t\t\t})\n\t\t\t.then(data => {\n\t\t\t\tconst newPhoto = {\n\t\t\t\t\tid: data.id,\n\t\t\t\t\t...photo\n\t\t\t\t}\n\t\t\t\tconst updatedUser = {\n\t\t\t\t\t...user,\n\t\t\t\t\tphotos: user.photos\n\t\t\t\t\t\t? user.photos.concat(newPhoto)\n\t\t\t\t\t\t: [newPhoto]\n\t\t\t\t}\n\n\t\t\t\tcloseModal()\n\t\t\t\tsetPhoto({})\n\t\t\t\tsetUploadDisabled(true)\n\t\t\t\tsetUser(updatedUser)\n\t\t\t})\n\t\t\t.catch(e => {\n\t\t\t\tconsole.log('Database error', e)\n\t\t\t})\n\t}\n\n\tconst isProfilePic = () => user.photos && user.photos.length > 0\n\t\t? 0\n\t\t: 1\n\n\n\treturn <Modal show={showModal} onHide={closeModal}>\n\t\t<Modal.Header closeButton>\n\t\t\t<Modal.Title>Upload photo</Modal.Title>\n\t\t</Modal.Header>\n\t\t<Modal.Body>\n\t\t\t<UploadPhoto photo={photo} setPhoto={setPhoto} profilePic={isProfilePic()}\n\t\t\t\tsetUploadDisabled={setUploadDisabled} />\n\t\t</Modal.Body>\n\t\t<Modal.Footer>\n\t\t\t<Button variant=\"secondary\" onClick={closeModal}>\n                    Close\n\t\t\t</Button>\n\t\t\t<Button variant=\"primary\" onClick={handleUpload} disabled={uploadDisabled}>\n                    Upload\n\t\t\t</Button>\n\t\t</Modal.Footer>\n\t</Modal>\n}\n\nexport default UploadModal","import React, { useState } from 'react'\nimport { ResponsiveEmbed, Button } from 'react-bootstrap'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faPlus } from '@fortawesome/free-solid-svg-icons'\nimport UploadModal from './UploadModal'\n\nconst EmptyBox = ({ user, setUser }) => {\n\n\tconst [showModal, setShowModal] = useState(false)\n\tconst openModal = () => setShowModal(true)\n\tconst closeModal = () => setShowModal(false)\n\n\tconst buttonStyle = {\n\t\tposition: 'absolute',\n\t\tbottom: '5px',\n\t\tright: '5px'\n\t}\n\n\treturn <ResponsiveEmbed aspectRatio=\"1by1\">\n\t\t<div className=\"border d-flex align-items-center\">\n\t\t\t<Button size=\"sm\" variant=\"light\" onClick={openModal} style={buttonStyle}>\n\t\t\t\t<FontAwesomeIcon icon={faPlus} />\n\t\t\t</Button>\n\t\t\t<UploadModal user={user} setUser={setUser} showModal={showModal}\n\t\t\t\tcloseModal={closeModal} />\n\t\t</div>\n\t</ResponsiveEmbed>\n}\n\nexport default EmptyBox","import React from 'react'\nimport { Button } from 'react-bootstrap'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faUser } from '@fortawesome/free-solid-svg-icons'\nimport photoService from '../../../services/photoService'\n\nconst ProfilePicButton = ({ photo, profilePic, user, setUser }) => {\n\n\tconst toggleProfilePic = () => {\n\n\t\tphotoService\n\t\t\t.toggleProfilePhoto(photo.id, 1)\n\t\t\t.then(() => {\n\t\t\t\tphotoService\n\t\t\t\t\t.toggleProfilePhoto(profilePic.id, 0)\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tconst updatedUser = {\n\t\t\t\t\t\t\t...user,\n\t\t\t\t\t\t\tphotos: user.photos.map(p => p.id === photo.id\n\t\t\t\t\t\t\t\t? { ...p, profilePic: 1 }\n\t\t\t\t\t\t\t\t: p.id = profilePic.id\n\t\t\t\t\t\t\t\t\t? { ...p, profilePic: 0 }\n\t\t\t\t\t\t\t\t\t: p)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsetUser(updatedUser)\n\t\t\t\t\t})\n\t\t\t\t\t.catch(e => {\n\t\t\t\t\t\tconsole.log('Database error', e)\n\t\t\t\t\t})\n\t\t\t})\n\t\t\t.catch(e => {\n\t\t\t\tconsole.log('Database error', e)\n\t\t\t})\n\t}\n\n\treturn photo.profilePic\n\t\t? <Button size=\"sm\" variant=\"light\" disabled>\n\t\t\t<FontAwesomeIcon icon={faUser} color=\"gold\" />\n\t\t</Button>\n\t\t: <Button size=\"sm\" variant=\"light\" onClick={toggleProfilePic}>\n\t\t\t<FontAwesomeIcon icon={faUser} />\n\t\t</Button>\n}\n\nexport default ProfilePicButton","import React from 'react'\nimport { Button } from 'react-bootstrap'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faTrash } from '@fortawesome/free-solid-svg-icons'\nimport photoService from '../../../services/photoService'\n\nconst DeletePhotoButton = ({ photo, user, setUser }) => {\n\n\tconst handleDelete = () => {\n\n\t\tphotoService\n\t\t\t.deletePhoto(photo.id)\n\t\t\t.then(() => {\n\n\t\t\t\tif (photo.profilePic) {\n\t\t\t\t\tconst newProfilePic = user.photos.find(p => !p.profilePic)\n\n\t\t\t\t\tif (newProfilePic) {\n\t\t\t\t\t\tphotoService\n\t\t\t\t\t\t\t.toggleProfilePhoto(newProfilePic.id, 1)\n\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\tconst updatedUser = {\n\t\t\t\t\t\t\t\t\t...user,\n\t\t\t\t\t\t\t\t\tphotos: user.photos\n\t\t\t\t\t\t\t\t\t\t.filter(p => p.id !== photo.id)\n\t\t\t\t\t\t\t\t\t\t.map(p => p.id === newProfilePic.id\n\t\t\t\t\t\t\t\t\t\t\t? { ...p, profilePic: 1 }\n\t\t\t\t\t\t\t\t\t\t\t: p)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tsetUser(updatedUser)\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch(e => {\n\t\t\t\t\t\t\t\tconsole.log('Database error', e)\n\t\t\t\t\t\t\t})\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst updatedUser = {\n\t\t\t\t\t\t\t...user,\n\t\t\t\t\t\t\tphotos: user.photos.filter(p => p.id !== photo.id)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsetUser(updatedUser)\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst updatedUser = {\n\t\t\t\t\t\t...user,\n\t\t\t\t\t\tphotos: user.photos.filter(p => p.id !== photo.id)\n\t\t\t\t\t}\n\t\t\t\t\tsetUser(updatedUser)\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(e => {\n\t\t\t\tconsole.log('Database error', e)\n\t\t\t})\n\t}\n\n\treturn <Button size=\"sm\" variant=\"danger\" onClick={handleDelete}>\n\t\t<FontAwesomeIcon icon={faTrash} />\n\t</Button>\n}\n\nexport default DeletePhotoButton","import React, { useState } from 'react'\nimport { Image, ResponsiveEmbed, ButtonGroup } from 'react-bootstrap'\nimport ProfilePicButton from './ProfilePicButton'\nimport DeletePhotoButton from './DeletePhotoButton'\n\nconst PhotoBox = ({ photo, user, setUser, profilePic }) => {\n\n\tconst [hovered, setHovered] = useState(false)\n\n\tconst imgStyle = {\n\t\tmaxWidth: hovered ? '101%' : '100%',\n\t\tmaxHeight: hovered ? '101%' : '100%',\n\t}\n\n\tconst buttonStyle = {\n\t\tdisplay: hovered ? 'block' : 'none',\n\t\tposition: 'absolute',\n\t\tbottom: '5px',\n\t\tright: '5px'\n\t}\n\n\treturn <ResponsiveEmbed aspectRatio=\"1by1\">\n\t\t<div className=\"border d-flex align-items-center img-fluid\"\n\t\t\tonMouseEnter={() => setHovered(true)}\n\t\t\tonMouseLeave={() => setHovered(false)}>\n\t\t\t<Image src={photo.photoStr} alt={user.username}\n\t\t\t\ttitle={user.username} className=\"d-block m-auto\"\n\t\t\t\tstyle={imgStyle} />\n\t\t\t<ButtonGroup style={buttonStyle}>\n\t\t\t\t<ProfilePicButton photo={photo} profilePic={profilePic} user={user} setUser={setUser} />\n\t\t\t\t<DeletePhotoButton photo={photo} user={user} setUser={setUser} />\n\t\t\t</ButtonGroup>\n\t\t</div>\n\t</ResponsiveEmbed>\n}\n\nexport default PhotoBox","import React, { useState, useEffect } from 'react'\nimport { Container, Row, Col } from 'react-bootstrap'\nimport EmptyBox from './EmptyBox'\nimport PhotoBox from './PhotoBox'\n\nconst UserPhotos = ({ user, setUser }) => {\n\n\tconst [profilePic, setProfilePic] = useState(null)\n\tconst maxPhotos = 5\n\tconst emptyPhotos = () => user.photos ? maxPhotos - user.photos.length : maxPhotos\n\n\tconst profilePhoto = () => profilePic\n\t\t? <Col>\n\t\t\t<PhotoBox photo={profilePic} user={user}\n\t\t\t\tsetUser={setUser} profilePic={profilePic} />\n\t\t</Col>\n\t\t: null\n\n\tconst photoBoxes = () => user.photos\n\t\t? user.photos.map(p => p.profilePic\n\t\t\t? null\n\t\t\t: <Col xs={6} key={p.id}>\n\t\t\t\t<PhotoBox photo={p} user={user} setUser={setUser} profilePic={profilePic} />\n\t\t\t</Col>)\n\t\t: null\n\n\tconst emptyBoxes = () => [...Array(emptyPhotos())]\n\t\t.map((e, i) =>\n\t\t\t<Col xs={6} key={i}>\n\t\t\t\t<EmptyBox photo={null} user={user} setUser={setUser} />\n\t\t\t</Col>)\n\n\tuseEffect(() => {\n\t\tif (user.photos && user.photos.length > 0)\n\t\t\tsetProfilePic(user.photos.find(p => p.profilePic))\n\t\telse\n\t\t\tsetProfilePic(null)\n\t}, [user.photos])\n\n\treturn <Container>\n\t\t<Row noGutters={true} >\n\t\t\t{profilePhoto()}\n\t\t</Row>\n\t\t<Row noGutters={true} >\n\t\t\t{photoBoxes()}\n\t\t\t{emptyPhotos() ? emptyBoxes() : null}\n\t\t</Row>\n\t</Container>\n\n}\n\nexport default UserPhotos\n","import React from 'react'\nimport { Form } from 'react-bootstrap'\n\nconst RequiredInputField = ({ label, errors, name, defVal, maxLen, requirements, register }) => (\n\t<Form.Group className=\"text-left\">\n\t\t<Form.Label htmlFor={`form-${name}`}>{label}</Form.Label>\n\t\t{errors && (<span className=\"text-danger\"> {errors.message}</span>)}<br />\n\n\t\t<Form.Control id={`form-${name}`} name={name} defaultValue={defVal} maxLength={maxLen}\n\t\t\tref={register({\n\t\t\t\t...requirements,\n\t\t\t\trequired: {\n\t\t\t\t\tvalue: true,\n\t\t\t\t\tmessage: '*'\n\t\t\t\t},\n\t\t\t\tmaxLength: {\n\t\t\t\t\tvalue: maxLen,\n\t\t\t\t\tmessage: `max length ${maxLen}`\n\t\t\t\t}\n\t\t\t})} />\n\t</Form.Group>\n)\n\nexport default RequiredInputField","import React, { useRef } from 'react'\nimport { Form } from 'react-bootstrap'\n\nconst PasswordFields = ({ watch, register, required, errors }) => {\n\tconst password = useRef({})\n\tpassword.current = watch('password', '')\n\n\treturn <>\n\t\t<Form.Group className=\"text-left\">\n\t\t\t<Form.Label>password</Form.Label>\n\t\t\t{errors.password && errors.password.message === '*'\n\t\t\t\t&& (<span className=\"text-danger\"> {errors.password.message}</span>)}<br />\n\n\t\t\t<input className=\"form-control\" name=\"password\" type=\"password\"\n\t\t\t\tdefaultValue=\"\" maxLength=\"50\" placeholder=\"password\"\n\t\t\t\tref={register({\n\t\t\t\t\trequired: {\n\t\t\t\t\t\tvalue: required,\n\t\t\t\t\t\tmessage: '*'\n\t\t\t\t\t},\n\t\t\t\t\tmaxLength: {\n\t\t\t\t\t\tvalue: 50,\n\t\t\t\t\t\tmessage: 'max length 50'\n\t\t\t\t\t},\n\t\t\t\t\tminLength: {\n\t\t\t\t\t\tvalue: 8,\n\t\t\t\t\t\tmessage: 'min length 8'\n\t\t\t\t\t},\n\t\t\t\t\tpattern: {\n\t\t\t\t\t\tvalue: /^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)[a-zA-Z\\d]{8,}$/,\n\t\t\t\t\t\tmessage: 'must contain a number, an upper and a lower case letter'\n\t\t\t\t\t}\n\t\t\t\t})} />\n\t\t\t{errors.password && errors.password.message !== '*'\n\t\t\t\t? <p className=\"text-danger\">{errors.password.message}</p>\n\t\t\t\t: <p></p>\n\t\t\t}\n\t\t</Form.Group>\n\t\t<Form.Group className=\"text-left\">\n\t\t\t<input className=\"form-control\" name=\"password2\" type=\"password\"\n\t\t\t\tdefaultValue=\"\" maxLength=\"50\" placeholder=\"confirm password\"\n\t\t\t\tref={register({ validate: value => value === password.current || 'passwords don\\'t match' })} />\n\t\t\t{errors.password2 && (<p className=\"text-danger\">{errors.password2.message}</p>)}\n\t\t</Form.Group>\n\t</>\n}\n\nexport default PasswordFields","import React from 'react'\nimport Select from 'react-select'\nimport { Controller } from 'react-hook-form'\nimport { Form } from 'react-bootstrap'\n\nconst SelectGender = ({ gender, control, errors }) => {\n\n\tconst options = [\n\t\t{ value: 'female', label: 'female' },\n\t\t{ value: 'male', label: 'male' },\n\t\t{ value: 'other', label: 'other' }\n\t]\n\n\tconst defVal = () => gender ? { value: gender, label: gender } : ''\n\n\treturn \t<Form.Group>\n\t\t<Form.Label htmlFor='select-gender'>gender</Form.Label>\n\t\t{errors.gender && errors.gender.type === 'required' && (<span className='text-danger'> *</span>)}<br />\n\t\t<Controller\n\t\t\tclass='form-control'\n\t\t\tid='select-gender'\n\t\t\tname='gender'\n\t\t\tas={Select}\n\t\t\toptions={options}\n\t\t\tvalue={{ value: gender, label: gender }}\n\t\t\tdefaultValue={defVal()}\n\t\t\tcontrol={control}\n\t\t\trules={{ required: true }} />\n\t</Form.Group>\n}\n\nexport default SelectGender","import React from 'react'\nimport Select from 'react-select'\nimport { Controller } from 'react-hook-form'\nimport { Form } from 'react-bootstrap'\n\nconst SelectOrientation = ({ orientation, control, errors }) => {\n\n\tconst options = [\n\t\t{ value: 'female', label: 'female' },\n\t\t{ value: 'male', label: 'male' },\n\t\t{ value: 'other', label: 'other' }\n\t]\n\n\t//console.log('orientation at select orientation', orientation)\n\n\tconst defVal = () => orientation ? orientation.map(o => ({ value: o, label: o })) : ''\n\n\treturn \t<Form.Group>\n\t\t<Form.Label htmlFor='select-orientation'>looking for</Form.Label>\n\t\t{errors.orientation && errors.orientation.type === 'required' && (<span className='text-danger'> *</span>)}<br />\n\n\t\t<Controller\n\t\t\tclass='form-control'\n\t\t\tid='select-orientation'\n\t\t\tname='orientation'\n\t\t\tas={Select}\n\t\t\toptions={options}\n\t\t\tvalue={defVal()}\n\t\t\tdefaultValue={defVal()}\n\t\t\tcontrol={control}\n\t\t\trules={{ required: true }}\n\t\t\tisMulti />\n\t</Form.Group>\n}\n\nexport default SelectOrientation\n","import axios from 'axios'\nconst baseUrl = '/api/tags'\n\nconst getTags = async () => {\n\tconst resp = await axios.get(baseUrl)\n\treturn resp.data\n}\n\nconst addTag = async tagObject => {\n\tconst resp = await axios.post(baseUrl, tagObject)\n\treturn resp.data\n}\n\nexport default { getTags, addTag }","import React, { useState, useEffect } from 'react'\nimport { Form } from 'react-bootstrap'\nimport CreatableSelect from 'react-select'\nimport tagService from '../../../services/tagService'\n\nconst SelectTags = ({ state, setState }) => {\n\n\tconst [options, setOptions] = useState([])\n\n\tconst handleChange = value => {\n\t\tsetState({ value })\n\t}\n\n\tconst handleInputChange = (inputValue) => {\n\t\tsetState({ inputValue, value: state.value || [] })\n\t}\n\n\tconst createOption = label => ({ label, value: label })\n\n\tconst handleKeyDown = (event) => {\n\t\tconst { inputValue, value } = state\n\n\t\tif (!inputValue) return\n\t\tswitch (event.key) {\n\t\tcase 'Enter':\n\t\tcase 'Tab':\n\t\t\tevent.preventDefault()\n\n\t\t\t// eslint-disable-next-line no-case-declarations\n\t\t\tconst newTag = inputValue.startsWith('#')\n\t\t\t\t? inputValue\n\t\t\t\t: '#' + inputValue\n\n\t\t\tif (value.find(o => o.label === newTag) !== undefined) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\telse if (options.find(o => o.label === newTag) !== undefined) {\n\n\t\t\t\tsetState({\n\t\t\t\t\tinputValue: '',\n\t\t\t\t\tvalue: [...value, createOption(newTag)]\n\t\t\t\t})\n\n\t\t\t\tsetOptions(options.filter(o => o.label !== newTag))\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\ttagService\n\t\t\t\t.addTag({ tag: newTag })\n\t\t\t\t.then(() => {\n\n\t\t\t\t\tsetState({\n\t\t\t\t\t\tinputValue: '',\n\t\t\t\t\t\tvalue: [...value, createOption(newTag)]\n\t\t\t\t\t})\n\n\t\t\t\t\tsetOptions(options.concat(createOption(newTag)))\n\n\t\t\t\t})\n\t\t\t\t.catch(e => {\n\t\t\t\t\tconsole.log('Database error', e)\n\t\t\t\t})\n\t\t\tbreak\n\t\tdefault:\n\t\t\treturn\n\t\t}\n\t}\n\n\tuseEffect(() => {\n\t\ttagService\n\t\t\t.getTags()\n\t\t\t.then(data => {\n\t\t\t\tsetOptions(data.map(t => createOption(t.tag)))\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tconsole.log(error)\n\t\t\t})\n\t}, [])\n\n\treturn <Form.Group>\n\t\t<Form.Label htmlFor='tags-select'>tags</Form.Label>\n\t\t<CreatableSelect\n\t\t\tid='tags-select'\n\t\t\tinputValue={state.inputValue}\n\t\t\tisClearable\n\t\t\tisMulti\n\t\t\tonChange={handleChange}\n\t\t\tonInputChange={handleInputChange}\n\t\t\tonKeyDown={handleKeyDown}\n\t\t\tvalue={state.value}\n\t\t\toptions={options}\n\t\t\tname='tags'\n\t\t/>\n\t</Form.Group>\n}\n\nexport default SelectTags","import React from 'react'\nimport { Form } from 'react-bootstrap'\n\nconst BioTextArea = ({ bio, register, errors }) => (\n\t<Form.Group>\n\t\t<Form.Label htmlFor='bio-textarea'>bio</Form.Label><br />\n\t\t<Form.Control as='textarea' id='bio-textarea' name='bio' defaultValue={bio} maxLength='1000'\n\t\t\tref={register({\n\t\t\t\tmaxLength: {\n\t\t\t\t\tvalue: 1000,\n\t\t\t\t\tmessage: 'max length 1000'\n\t\t\t\t}\n\t\t\t})} />\n\t\t{errors && (<p className='text-danger'>{errors.message}</p>)}\n\t</Form.Group>\n)\n\nexport default BioTextArea","const orientationToDb = selected => {\n\n\tif (!selected)\n\t\treturn ''\n\tif (selected.length === 3)\n\t\treturn 'fmo'\n\tif (selected.length === 1)\n\t\treturn selected[0].value.substring(0, 1)\n\tif (!selected.map(o => o.value).find(v => v === 'female'))\n\t\treturn 'mo'\n\tif (!selected.map(o => o.value).find(v => v === 'male'))\n\t\treturn 'fo'\n\treturn 'fm'\n}\n\nconst userTagsFromDb = tags => tags\n\t? tags.split('#').map(t => ({ label: `#${t}`, value: `#${t}` })).slice(1)\n\t: []\n\nexport default { orientationToDb, userTagsFromDb }","import React, { useState } from 'react'\nimport { useForm } from 'react-hook-form'\nimport { Form, Button } from 'react-bootstrap'\nimport userService from '../../../services/userService'\nimport RequiredInputField from '../../UI/Forms/RequiredInputField'\nimport PasswordFields from '../../UI/Forms/PasswordFields'\nimport SelectGender from '../../UI/Forms/SelectGender'\nimport SelectOrientation from '../../UI/Forms/SelectOrientation'\nimport SelectTags from '../../UI/Forms/SelectTags'\nimport BioTextArea from '../../UI/Forms/BioTextArea'\nimport dbFunctions from '../../../utils/dbFunctions'\n\nconst UpdateUserForm = ({ user, setUser }) => {\n\n\tconst [errorMessage, setErrorMessage] = useState('')\n\tconst [notification, setNotification] = useState('')\n\tconst [userTagsState, setUserTagsState] = useState({\n\t\tvalue: dbFunctions.userTagsFromDb(user.tags),\n\t\tinputValue: ''\n\t})\n\tconst { register, handleSubmit, errors, control, watch, reset } = useForm()\n\n\tconst onSubmit = data => {\n\n\t\t// eslint-disable-next-line no-unused-vars\n\t\tconst { password, password2, ...updatedUser } = data\n\n\t\tupdatedUser.gender = data.gender.value\n\t\tupdatedUser.orientation = dbFunctions.orientationToDb(data.orientation)\n\t\tupdatedUser.tags = userTagsState.value && userTagsState.value.length !== 0\n\t\t\t? userTagsState.value.map(t => t.value).join('')\n\t\t\t: ''\n\n\t\tif (password) {\n\t\t\tupdatedUser.password = password\n\t\t\treset({ password: '', password2: '' })\n\t\t}\n\n\t\tuserService\n\t\t\t.updateUser(updatedUser, user.user_id)\n\t\t\t.then(data => {\n\t\t\t\tsetErrorMessage('')\n\t\t\t\tsetNotification('user updated')\n\t\t\t\tsetUser({\n\t\t\t\t\t...user,\n\t\t\t\t\t...data\n\t\t\t\t})\n\t\t\t})\n\t\t\t.catch(e => {\n\t\t\t\tif (e.response && e.response.data)\n\t\t\t\t\tsetErrorMessage(e.response.data.error)\n\t\t\t\telse\n\t\t\t\t\tconsole.log('Database error', e)\n\n\t\t\t\tsetNotification('')\n\t\t\t})\n\t}\n\n\treturn <Form onSubmit={handleSubmit(onSubmit)} className=\"mt-3\">\n\n\t\t<RequiredInputField label='first name' errors={errors.firstName}\n\t\t\tname=\"firstName\" defVal={user.firstName} maxLen='50' register={register} />\n\n\t\t<RequiredInputField label='last name' errors={errors.lastName}\n\t\t\tname=\"lastName\" defVal={user.lastName} maxLen='50' register={register} />\n\n\t\t<RequiredInputField label='email' errors={errors.email}\n\t\t\tname=\"email\" defVal={user.email} maxLen='255' register={register}\n\t\t\trequirements={{\n\t\t\t\tpattern: {\n\t\t\t\t\tvalue: /^[a-zA-Z0-9.!#$%&'*+/=?^_`{ | }~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/,\n\t\t\t\t\tmessage: 'not a valid email'\n\t\t\t\t}\n\t\t\t}} />\n\n\t\t<SelectGender gender={user.gender} control={control} errors={errors} />\n\n\t\t<SelectOrientation orientation={user.orientation} control={control} errors={errors} />\n\n\t\t<SelectTags name='tags' state={userTagsState} setState={setUserTagsState} control={control} errors={errors} />\n\n\t\t<BioTextArea bio={user.bio} register={register} errors={errors.bio} />\n\n\t\t<PasswordFields watch={watch} register={register} errors={errors} />\n\n\t\t{errorMessage && <div className=\"text-danger\" >{errorMessage}</div>}\n\t\t{notification && <div className=\"text-success\" >{notification}</div>}\n\n\t\t<div className=\"text-right mt-3\">\n\t\t\t<Button type=\"submit\">Update</Button>\n\t\t</div>\n\t</Form>\n}\n\nexport default UpdateUserForm","import React, { useEffect, useState } from 'react'\nimport { GoogleMap, LoadScript, Marker } from '@react-google-maps/api'\n//import { api } from '../../../secret.json'\nimport userService from '../../../services/userService'\n\nconst containerStyle = {\n\twidth: '90vw',\n\theight: '90vw',\n\tmaxWidth: '400px',\n\tmaxHeight: '400px',\n\tmargin: '2em auto'\n}\n\nconst Map = ({ user, setUser }) => {\n\tconst [mapCentre, setMapCentre] = useState({ lat: 0, lng: 0 })\n\n\tuseEffect(() => {\n\t\tsetMapCentre({ lat: user.latitude, lng: user.longitude })\n\t}, [user])\n\n\tconst dragEndHandler= (e) => {\n\t\tconst latitude = e.latLng.lat()\n\t\tconst longitude = e.latLng.lng()\n\t\tconst userObject = {\n\t\t\tlatitude,\n\t\t\tlongitude\n\t\t}\n\n\t\tuserService.updateUser(userObject, user.user_id)\n\t\t\t.then(res => {\n\t\t\t\tsetUser({ ...user, latitude: res.latitude, longitude: res.longitude })\n\t\t\t})\n\t\t\t.catch(e => {\n\t\t\t\tconsole.log('Database error', e)\n\t\t\t})\n\t}\n\n\treturn <p>map</p>/*(\n\t\t<LoadScript googleMapsApiKey={api} >\n\t\t\t<GoogleMap\n\t\t\t\tmapContainerStyle={containerStyle}\n\t\t\t\tcenter={mapCentre}\n\t\t\t\tzoom={6}\n\t\t\t>\n\t\t\t\t<Marker\n\t\t\t\t\tdraggable={true}\n\t\t\t\t\tposition={mapCentre}\n\t\t\t\t\tonDragEnd= {event => dragEndHandler(event)}\n\t\t\t\t/>\n\t\t\t</GoogleMap>\n\t\t</LoadScript>\n\t)*/\n}\n\nexport default Map","import axios from 'axios'\nimport auth from '../utils/auth'\nconst baseUrl = '/api/visits'\n\nconst addVisit = async userObject => {\n\tconst resp = await axios.post(baseUrl, userObject, auth.config())\n\treturn resp.data\n}\n\nconst visitHistory = async to => {\n\tconst resp = await axios.get(`${baseUrl}?to=${to}`, auth.config())\n\treturn resp.data\n}\n\nexport default { addVisit, visitHistory }","import React, { useState, useEffect } from 'react'\nimport { ListGroup } from 'react-bootstrap'\nimport { Link } from 'react-router-dom'\nimport TimeAgo from 'react-timeago'\nimport visitService from '../../../services/visitService'\n\nconst VisitHistory = ({ user }) => {\n\n\tconst [visitHistory, setVisitHistory] = useState([])\n\n\tuseEffect(() => {\n\n\t\tvisitService\n\t\t\t.visitHistory(false)\n\t\t\t.then(res => {\n\t\t\t\tsetVisitHistory(res)\n\t\t\t})\n\t\t\t.catch(e => {\n\t\t\t\tconsole.log('Database error', e)\n\t\t\t})\n\n\t}, [user.username])\n\n\n\treturn visitHistory && visitHistory.length > 0\n\t\t? <ListGroup className='text-left'>\n\t\t\t{visitHistory.map(u => <ListGroup.Item action key={u.username}>\n\t\t\t\t<Link to={`browse/?user_id=${u.to_user_id}`}>{u.username}</Link> <TimeAgo date={u.date} live={false} />\n\t\t\t</ListGroup.Item>\n\t\t\t)}\n\t\t</ListGroup>\n\t\t: <div className=\"text-info\">Your visit history is empty</div>\n}\n\nexport default VisitHistory","import axios from 'axios'\nimport auth from '../utils/auth'\nconst baseUrl = '/api/block'\n\nconst block = async user_id => {\n\tconst resp = await axios.post(baseUrl, { to_user_id: user_id }, auth.config())\n\treturn resp.data\n}\n\nconst getAllBlocked = async () => {\n\tconst resp = await axios.get(baseUrl, auth.config())\n\treturn resp.data\n}\n\nconst getBlockedId = async user_id => {\n\tconst resp = await axios.get(`${baseUrl}?user_id=${user_id}`, auth.config())\n\treturn resp.data\n}\n\nconst getBlockedByUser = async user_id => {\n\tconst resp = await axios.get(`${baseUrl}?from_user_id=${user_id}`, auth.config())\n\treturn resp.data\n}\n\nconst unblockUser = async id => {\n\tconst resp = await axios.delete(`${baseUrl}/${id}`, auth.config())\n\treturn resp.data\n}\n\nexport default { block, getAllBlocked, getBlockedId, getBlockedByUser, unblockUser }","import React, { useState, useEffect } from 'react'\nimport { ListGroup, Button } from 'react-bootstrap'\nimport blockService from '../../../services/blockService'\n\nconst BlockList = ({ user }) => {\n\tconst [blockedUsers, setBlockedUsers] = useState([])\n\n\tuseEffect(() => {\n\t\tblockService\n\t\t\t.getBlockedByUser(user.user_id)\n\t\t\t.then(res => {\n\t\t\t\tsetBlockedUsers(res.filter(r => r.from_user_id === user.user_id))\n\t\t\t})\n\t\t\t.catch(e => {\n\t\t\t\tconsole.log('Database error', e)\n\t\t\t})\n\t}, [user.user_id])\n\n\tconst unblockUser = block_id => {\n\n\t\tblockService\n\t\t\t.unblockUser(block_id)\n\t\t\t.then(() => {\n\t\t\t\tsetBlockedUsers(blockedUsers.filter(u => u.block_id !== block_id))\n\t\t\t})\n\t\t\t.catch(e => {\n\t\t\t\tconsole.log('Database error', e)\n\t\t\t})\n\t}\n\n\treturn blockedUsers && blockedUsers.length > 0\n\t\t? <ListGroup className=\"text-left\" variant=\"flush\">\n\t\t\t{blockedUsers.map(u =>\n\t\t\t\t<ListGroup.Item key={u.username}>\n\t\t\t\t\t<div style={{ display: 'inline-block', width: '60%' }}>{u.username}</div>\n\t\t\t\t\t<div style={{ display: 'inline-block', width: '40%', textAlign: 'right' }}>\n\t\t\t\t\t\t<Button onClick={() => unblockUser(u.block_id)} variant=\"outline-primary\">Unblock</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</ListGroup.Item>\n\t\t\t)}\n\t\t</ListGroup>\n\n\t\t: <div className=\"text-info\">Your block list is empty</div>\n\n}\n\nexport default BlockList","import React, { useState } from 'react'\nimport { Button } from 'react-bootstrap'\n\nconst Togglable = (props) => {\n\tconst [visible, setVisible] = useState(false)\n\n\tconst showWhenVisible = { display: visible ? '' : 'none' }\n\n\treturn <>\n\t\t<div className='pb-1 pt-1 d-flex justify-content-between align-items-baseline'\n\t\t\tonClick={() => setVisible(!visible)} style={{ cursor: 'pointer' }}>\n\t\t\t<span className='font-weight-bold'>{props.title || ''}</span>\n\n\t\t\t<Button variant='link'>\n\t\t\t\t{visible ? props.hideText || 'hide' : props.showText || 'show'}\n\t\t\t</Button>\n\t\t</div>\n\t\t<div style={showWhenVisible}>\n\t\t\t{props.children}\n\t\t</div>\n\t</>\n}\n\nexport default Togglable","import React from 'react'\nimport UserPhotos from './UserPhotos'\nimport UpdateUserForm from './UpdateUserForm'\nimport Map from './Map/index'\nimport VisitHistory from './VisitHistory/index.js'\nimport BlockList from './BlockList/index'\nimport Togglable from '../UI/Togglable'\n\n\nconst UserProfile = ({ user, setUser }) => {\n\n\treturn <>\n\t\t<h1>{user.username}</h1>\n\t\t<div className='text-left pt-3'>\n\n\t\t\t<Togglable title='Photos'>\n\t\t\t\t<UserPhotos user={user} setUser={setUser} />\n\t\t\t</Togglable>\n\t\t\t<hr />\n\n\t\t\t<Togglable title='User information'>\n\t\t\t\t<UpdateUserForm user={user} setUser={setUser} />\n\t\t\t</Togglable>\n\t\t\t<hr />\n\n\t\t\t<Togglable title='Location'>\n\t\t\t\t<Map user={user} setUser={setUser} />\n\t\t\t</Togglable>\n\t\t\t<hr />\n\n\t\t\t<Togglable title='Visit history'>\n\t\t\t\t<VisitHistory user={user} />\n\t\t\t</Togglable>\n\t\t\t<hr />\n\n\t\t\t<Togglable title='Blocked users'>\n\t\t\t\t<BlockList user={user} />\n\t\t\t</Togglable>\n\t\t</div>\n\t</>\n}\n\nexport default UserProfile","import React, { useRef } from 'react'\nimport { Form, Col } from 'react-bootstrap'\n\nconst BirthdateField = ({ errors, register, watch }) => {\n\n\tconst day = useRef(null)\n\tconst month = useRef(null)\n\n\tday.current = watch('birthdate.day', '')\n\tmonth.current = watch('birthdate.month', '')\n\n\tconst valueMissing = () => (errors.day && errors.day.type === 'required') ||\n\t(errors.month && errors.month.type === 'required') || (errors.year && errors.year.type === 'required')\n\n\tconst isValidDate = year => {\n\t\tconst date = new Date(year, (+month.current-1), day.current)\n\t\treturn +date && date.getDate() === +day.current\n\t}\n\n\treturn <div className=\"text-left\">\n\n\t\t<Form.Label >birthdate</Form.Label>\n\t\t<span className=\"text-danger\"> { errors && valueMissing() && '*'}</span>\n\t\t<span className=\"text-danger\"> { errors && !valueMissing() && 'not a valid date'}</span><br />\n\n\t\t<Form.Row>\n\t\t\t<Col xs={3}>\n\t\t\t\t<Form.Group>\n\t\t\t\t\t<Form.Label>day</Form.Label>\n\t\t\t\t\t<Form.Control name='birthdate.day' placeholder='dd' defaultValue='' maxLength='2'\n\t\t\t\t\t\tref={register({\n\t\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\t\tmaxLength: 2\n\t\t\t\t\t\t})} />\n\t\t\t\t</Form.Group>\n\t\t\t</Col>\n\t\t\t<Col xs={3}>\n\t\t\t\t<Form.Group>\n\t\t\t\t\t<Form.Label>month</Form.Label>\n\t\t\t\t\t<Form.Control name='birthdate.month' placeholder='mm' defaultValue='' maxLength='2'\n\t\t\t\t\t\tref={register({\n\t\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\t\tmaxLength: 2\n\t\t\t\t\t\t})} />\n\t\t\t\t</Form.Group>\n\t\t\t</Col>\n\t\t\t<Col xs={6}>\n\t\t\t\t<Form.Group>\n\t\t\t\t\t<Form.Label>year</Form.Label>\n\t\t\t\t\t<Form.Control name='birthdate.year' placeholder='yyyy' defaultValue='' maxLength='4'\n\t\t\t\t\t\tref={register({\n\t\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\t\tmaxLength: 4,\n\t\t\t\t\t\t\tvalidate: value => isValidDate(value)\n\t\t\t\t\t\t})} />\n\t\t\t\t</Form.Group>\n\t\t\t</Col>\n\t\t</Form.Row>\n\t</div>\n}\n\nexport default BirthdateField","import React, { useState } from 'react'\nimport { useForm } from 'react-hook-form'\nimport { Form, Col, Button } from 'react-bootstrap'\nimport userService from '../../services/userService'\nimport PasswordFields from '../UI/Forms/PasswordFields'\nimport RequiredInputField from '../UI/Forms/RequiredInputField'\nimport BirthdateField from './BirthdateField'\n\nconst Signup = () => {\n\tconst { register, handleSubmit, errors, watch } = useForm()\n\tconst [errorMessage, setErrorMessage] = useState('')\n\tconst [notification, setNotification] = useState('')\n\n\tconst onSubmit = (data, e) => {\n\n\t\tconst rand = () => Math.random(0).toString(36).substr(2)\n\t\tconst token_check = (length) => (rand() + rand() + rand() + rand()).substr(0, length)\n\t\tconst token = token_check(100)\n\n\t\tconst userObject = {\n\t\t\t...data,\n\t\t\ttoken,\n\t\t\tbirthdate: `${data.birthdate.year}-${data.birthdate.month}-${data.birthdate.day}`\n\t\t}\n\n\t\tuserService\n\t\t\t.createUser(userObject)\n\t\t\t.then(() => {\n\t\t\t\tconsole.log('user added')\n\t\t\t\tif (errorMessage)\n\t\t\t\t\tsetErrorMessage('')\n\t\t\t\tsetNotification('signup succesfull, check your email')\n\t\t\t\te.target.reset()\n\t\t\t})\n\t\t\t.catch(e => {\n\t\t\t\tif (e.response && e.response.data)\n\t\t\t\t\tsetErrorMessage(e.response.data.error)\n\t\t\t\telse\n\t\t\t\t\tconsole.log('Database error', e)\n\t\t\t})\n\t}\n\treturn (\n\t\t<>\n\t\t\t<h1 className=\"text-center mt-3 mb-5\">Signup</h1>\n\n\t\t\t{notification\n\t\t\t\t? <div className=\"text-center text-success\" >{notification}</div>\n\n\t\t\t\t: <Form onSubmit={handleSubmit(onSubmit)}>\n\n\t\t\t\t\t<Form.Row>\n\t\t\t\t\t\t<Col>\n\t\t\t\t\t\t\t<RequiredInputField label='first name' errors={errors.firstName}\n\t\t\t\t\t\t\t\tname='firstName' defVal='' maxLen='50'\n\t\t\t\t\t\t\t\tregister={register} />\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t<Col>\n\t\t\t\t\t\t\t<RequiredInputField label='last name' errors={errors.lastName}\n\t\t\t\t\t\t\t\tname='lastName' defVal='' maxLen='50'\n\t\t\t\t\t\t\t\tregister={register} />\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t</Form.Row>\n\n\t\t\t\t\t<RequiredInputField label='username' errors={errors.username}\n\t\t\t\t\t\tname='username' defVal='' maxLen='255'\n\t\t\t\t\t\tregister={register} />\n\n\t\t\t\t\t<BirthdateField register={register} errors={errors.birthdate} watch={watch} />\n\n\t\t\t\t\t<RequiredInputField label='email' errors={errors.email}\n\t\t\t\t\t\tname='email' defVal='' maxLen='255'\n\t\t\t\t\t\tregister={register} requirements={{\n\t\t\t\t\t\t\tpattern: {\n\t\t\t\t\t\t\t\tvalue: /^[a-zA-Z0-9.!#$%&'*+/=?^_`{ | }~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/,\n\t\t\t\t\t\t\t\tmessage: 'not a valid email'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}} />\n\n\t\t\t\t\t<PasswordFields watch={watch} register={register} errors={errors}\n\t\t\t\t\t\trequired={true} />\n\n\t\t\t\t\t{errorMessage && <div className=\"text-center text-danger\" >{errorMessage}</div>}\n\n\t\t\t\t\t<Button className=\"btn-success mt-3\" type=\"submit\">Register</Button>\n\t\t\t\t</Form>\n\t\t\t}\n\t\t</>\n\t)\n}\n\nexport default Signup","import axios from 'axios'\n\nconst baseUrl = '/api/login'\n\nconst login = async credentials => {\n\n\tconst orientationFromDb = orientation => {\n\t\tconst o = []\n\n\t\tif (!orientation)\n\t\t\treturn o\n\t\tif (orientation.includes('f'))\n\t\t\to.push('female')\n\t\tif (orientation.includes('m'))\n\t\t\to.push('male')\n\t\tif (orientation.includes('o'))\n\t\t\to.push('other')\n\t\treturn o\n\t}\n\n\tconst resp = await axios.post(baseUrl, credentials)\n\n\tconst { orientation, ...user } = resp.data\n\n\treturn ({\n\t\t...user,\n\t\torientation: orientationFromDb(orientation),\n\t})\n}\n\nexport default { login }","import React, { useEffect, useState } from 'react'\nimport { Link } from 'react-router-dom'\nimport loginService from '../../services/loginService'\nimport { userGeoLocation } from '../../modules/geolocate'\nimport auth from '../../utils/auth'\nimport socket from '../../socket'\n\nconst Login = ({ setUser, wsClient }) => {\n\tconst [username, setUsername] = useState('')\n\tconst [password, setPassword] = useState('')\n\tconst [errorMessage, setErrorMessage] = useState(null)\n\n\tuseEffect(() => {\n\t\tuserGeoLocation()\n\t}, [])\n\n\tconst handleLogin = event => {\n\t\tevent.preventDefault()\n\t\tconst coords = JSON.parse(window.localStorage.getItem('coordinates'))\n\n\t\tloginService\n\t\t\t.login({\n\t\t\t\tusername,\n\t\t\t\tpassword,\n\t\t\t\tlongitude: coords ? coords.longitude : null,\n\t\t\t\tlatitude: coords ? coords.latitude : null\n\t\t\t})\n\t\t\t.then(data => {\n\n\t\t\t\twindow.localStorage.setItem('loggedMatchaUser', JSON.stringify({\n\t\t\t\t\tsessionToken: data.sessionToken,\n\t\t\t\t\tuser_id: data.user_id\n\t\t\t\t}))\n\t\t\t\tauth.setToken(data.sessionToken)\n\t\t\t\twsClient.current = socket.createWs(data.user_id)\n\t\t\t\tsetUsername('')\n\t\t\t\tsetPassword('')\n\t\t\t\tsetErrorMessage(null)\n\t\t\t\tsetUser(data)\n\t\t\t})\n\t\t\t.catch(e => {\n\t\t\t\tif (e.response && e.response.data)\n\t\t\t\t\tsetErrorMessage(e.response.data.error)\n\t\t\t\telse\n\t\t\t\t\tconsole.log('Database error', e)\n\t\t\t})\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<h1 className=\"text-center mt-3\">Login</h1>\n\n\t\t\t<form onSubmit={handleLogin}>\n\t\t\t\t{errorMessage && <div className=\"text-danger\" >{errorMessage}</div>}\n\t\t\t\t<div className=\"form-group mt-3\">\n\t\t\t\t\t<input className=\"form-control\"\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tname=\"username\"\n\t\t\t\t\t\tvalue={username}\n\t\t\t\t\t\tonChange={({ target }) => setUsername(target.value)}\n\t\t\t\t\t\tplaceholder=\"Username\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"form-group mt-3\">\n\t\t\t\t\t<input className=\"form-control\"\n\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\tname=\"password\"\n\t\t\t\t\t\tvalue={password}\n\t\t\t\t\t\tonChange={({ target }) => setPassword(target.value)}\n\t\t\t\t\t\tplaceholder=\"Password\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<button className=\"btn btn-success mt-3\" type=\"submit\">Login</button>\n\t\t\t\t<p className=\"forgot-password text-right\">\n\t\t\t\t\t<Link to={'/forgot'}>Forgot password?</Link>\n\t\t\t\t</p>\n\t\t\t</form>\n\t\t</>\n\t)\n}\n\nexport default Login","export const userGeoLocation = () => {\n\tif (navigator.geolocation){\n\t\tnavigator.geolocation.getCurrentPosition(position => {\n\t\t\tif (!position.coords.longitude || !position.coords.latitude)\n\t\t\t\treturn\n\t\t\telse{\n\t\t\t\tlocalStorage.setItem('coordinates', JSON.stringify({\n\t\t\t\t\tlatitude: position.coords.latitude,\n\t\t\t\t\tlongitude: position.coords.longitude\n\t\t\t\t}))\n\t\t\t}\n\t\t})\n\t}\n}\n/*\nexport const getGeoLocation = ()  => {\n\tconst coords = localStorage.getItem('coordinates');\n\tlocalStorage.removeItem('coordinates');\n\n\tif (!coords)\n\t{\n\t\treturn {\n\t\t\tlatitude: null,\n\t\t\tlongitude: null\n\t\t}\n\t}\n\telse {\n\t\tconst parsed = JSON.parse(coords)\n\t\treturn {\n\t\t\tlatitude: parsed.latitude,\n\t\t\tlongitude: parsed.longitude\n\t\t}\n\t}\n}*/","import React from 'react'\nimport Login from '../Login'\n\nconst Verify = ({ setUser, wsClient }) => {\n\n\treturn <>\n\t\t<p className=\"text-center text-success\">account verified</p>\n\t\t<Login setUser={setUser} wsClient={wsClient} />\n\t</>\n}\n\nexport default Verify","import axios from 'axios'\nconst baseUrl = '/api/reset'\n\nconst resetUrl = '/api/reset/new-password'\n\nconst forgotPass = async email => {\n\tconst resp = await axios.post(baseUrl, email)\n\treturn resp.data\n}\n\nconst resetPass = async newpass => {\n\tconst resp = await axios.post(resetUrl, newpass)\n\treturn resp.data\n}\n\nexport default { forgotPass, resetPass }","import React, { useState } from 'react'\nimport forgotPasswdService from '../../services/forgotpassService'\n\nconst ForgotPassword = () => {\n\tconst [email, setEmail] = useState('')\n\tconst [message, setMessage] = useState(null)\n\tconst [errMessage, setErrmessage] = useState(null)\n\n\tconst forgotHandler = e => {\n\t\te.preventDefault()\n\t\tforgotPasswdService\n\t\t\t.forgotPass({ email })\n\t\t\t.then(function (response){\n\t\t\t\tsetMessage(response.message)\n\t\t\t\tsetErrmessage('')\n\t\t\t\tsetEmail('')\n\t\t\t})\n\t\t\t.catch(function (error){\n\t\t\t\tsetErrmessage(error.response.data.error)\n\t\t\t\tsetMessage('')\n\t\t\t})\n\t}\n\treturn <>\n\t\t<h1 className=\"mt-3\">Forgot password</h1>\n\t\t<div className=\"align-items-center\">\n\t\t\t<form onSubmit={forgotHandler}>\n\t\t\t\t{errMessage && <div className=\"text-danger\" ><strong>{errMessage}</strong></div>}\n\t\t\t\t{message && <div className=\"text-success\" ><strong>{message}</strong></div>}\n\t\t\t\t<div className=\"form-group mt-3\">\n\t\t\t\t\t<input className=\"form-control\"\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tname=\"email\"\n\t\t\t\t\t\tvalue={email}\n\t\t\t\t\t\tonChange={({ target }) => setEmail(target.value)}\n\t\t\t\t\t\tplaceholder=\"Type your email\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<button className=\"btn btn-success mt-3\" type=\"submit\">Submit</button>\n\t\t\t</form>\n\t\t</div>\n\t</>\n}\n\nexport default ForgotPassword","import React, { useState } from 'react'\nimport resetPassService from '../../services/forgotpassService'\nimport { useParams } from 'react-router-dom'\n\nconst ResetPassword = () => {\n\tconst [password, setPassword] = useState('')\n\tconst [cpassword, setCpassword] = useState('')\n\tconst [status, setStatus] = useState('')\n\tconst [errmsg, setErrmsg] = useState('')\n\tlet { token } = useParams()\n\n\tconst inputValidation = () => {\n\t\tif (password === '' || cpassword === '')\n\t\t\treturn false\n\t\telse\n\t\t\treturn true\n\t}\n\n\tconst resetForm = (e) => {\n\t\te.preventDefault()\n\n\t\tif (!inputValidation()) {\n\t\t\tsetErrmsg('All fields must be filled up')\n\t\t\treturn\n\t\t}\n\t\tif (password === cpassword) {\n\t\t\t//axios data here\n\t\t\tresetPassService\n\t\t\t\t.resetPass({ password, token })\n\t\t\t\t.then(function (response) {\n\t\t\t\t\tsetStatus(response.message)\n\t\t\t\t\tsetPassword('')\n\t\t\t\t\tsetCpassword('')\n\t\t\t\t\tsetErrmsg('')\n\t\t\t\t})\n\t\t\t\t.catch(function (error) {\n\t\t\t\t\tsetErrmsg(error.response.data.error)\n\t\t\t\t\tsetStatus('')\n\t\t\t\t})\n\t\t}\n\t\telse {\n\t\t\tsetErrmsg('Password mismatch')\n\t\t\treturn\n\t\t}\n\t}\n\n\treturn <>\n\t\t<h1 className=\"text-center mt-3\">Reset your password</h1>\n\t\t<form onSubmit={resetForm}>\n\t\t\t{status && <div className=\"text-success\" ><strong>{status}</strong></div>}\n\t\t\t{errmsg && <div className=\"text-danger\" ><strong>{errmsg}</strong></div>}\n\t\t\t<div className=\"form-group mt-3\">\n\t\t\t\t<input className=\"form-control\"\n\t\t\t\t\ttype=\"password\"\n\t\t\t\t\tname=\"password\"\n\t\t\t\t\tvalue={password}\n\t\t\t\t\tonChange={e => setPassword(e.target.value)}\n\t\t\t\t\tplaceholder=\"Type a new password\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div className=\"form-group mt-3\">\n\t\t\t\t<input className=\"form-control\"\n\t\t\t\t\ttype=\"password\"\n\t\t\t\t\tname=\"cpassword\"\n\t\t\t\t\tvalue={cpassword}\n\t\t\t\t\tonChange={e => setCpassword(e.target.value)}\n\t\t\t\t\tplaceholder=\"Confirm new password\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<button className=\"btn btn-success mt-3\" type=\"submit\">Submit</button>\n\t\t</form>\n\t</>\n}\n\nexport default ResetPassword","import React, { useState, useEffect } from 'react'\nimport { Card } from 'react-bootstrap'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faCircle } from '@fortawesome/free-solid-svg-icons'\n\n\nconst SelectorIcon = ({ selected, handleClick }) => {\n\n\treturn <Card.Link href=\"#\" onClick={handleClick}>\n\t\t<FontAwesomeIcon icon={faCircle} color={ selected ? 'gold' : 'grey' } />\n\t</Card.Link>\n}\n\nconst PhotoSelector = ({ selectedPhoto, setSelectedPhoto, profilePic, photos }) => {\n\n\tconst changePhoto = id => setSelectedPhoto(photos.find(p => p.id === id))\n\n\treturn <Card.Body className=\"text-center\">\n\n\t\t<SelectorIcon\n\t\t\tselected={ selectedPhoto.id === profilePic.id }\n\t\t\thandleClick={ () => changePhoto(profilePic.id) }\n\t\t/>\n\n\t\t{ photos\n\t\t\t.filter(p => !p.profilePic)\n\t\t\t.map(p => <SelectorIcon\n\t\t\t\tkey={p.id}\n\t\t\t\tselected={ selectedPhoto.id === p.id }\n\t\t\t\thandleClick={ () => changePhoto(p.id) }\n\t\t\t/>\n\t\t\t)}\n\t</Card.Body>\n}\n\nconst Photos = ({ photos }) => {\n\n\tconst [selectedPhoto, setSelectedPhoto] = useState(null)\n\tconst profilePic = photos ? photos.find(p => p.profilePic) : null\n\n\tuseEffect(() => {\n\t\tsetSelectedPhoto(profilePic)\n\t}, [profilePic])\n\n\tconst photoSelectorProps = {\n\t\tselectedPhoto, setSelectedPhoto, profilePic, photos\n\t}\n\n\treturn selectedPhoto && <>\n\t\t<Card.Img src={selectedPhoto.photoStr} />\n\t\t<PhotoSelector {...photoSelectorProps} />\n\t</>\n}\n\nexport default Photos","import React from 'react'\nimport { OverlayTrigger, Tooltip, Button, Card } from 'react-bootstrap'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faHeart, faFlag, faBan } from '@fortawesome/free-solid-svg-icons'\n\nconst DisabledLikeButton = () => <OverlayTrigger overlay={\n\t<Tooltip id=\"tooltip-disabled\">You must have a profile picture to like users</Tooltip>}>\n\t<span>\n\t\t<Button variant=\"link\" className=\"disabled\">\n\t\t\t<FontAwesomeIcon icon={faHeart} /> Like\n\t\t</Button>\n\t</span>\n</OverlayTrigger>\n\nconst LikeButton = ({ action, icon, text }) =>\n\t<Button variant=\"link\" onClick={e => action(e)}>\n\t\t<FontAwesomeIcon icon={icon} /> {text}\n\t</Button>\n\nconst ActionButton = ({ action, icon, text, setConfirmationModal, username }) =>\n\t<Button variant=\"link\" onClick={() => setConfirmationModal({ action, text, username })}>\n\t\t<FontAwesomeIcon icon={icon} /> {text}\n\t</Button>\n\n\nconst ActionButtons = ({ liked, hasPhoto, likeHandler, reportHandler, blockHandler, ...actionButtonProps }) => (\n\n\t<Card.Body>\n\t\t{\n\t\t\thasPhoto || liked\n\t\t\t\t? <LikeButton action={likeHandler} icon={faHeart} text={ liked ? ' Unlike' : ' Like' } />\n\t\t\t\t: <DisabledLikeButton likeHandler={likeHandler}  />\n\t\t}\n\t\t<ActionButton action={reportHandler} icon={faFlag} text=\" Report\" { ...actionButtonProps } />\n\t\t<ActionButton action={blockHandler} icon={faBan} text=\" Block\" { ...actionButtonProps } />\n\t</Card.Body>\n\n)\n\nexport default ActionButtons","import React from 'react'\nimport { Card, ListGroup, ListGroupItem } from 'react-bootstrap'\nimport TimeAgo from 'react-timeago'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faCircle } from '@fortawesome/free-solid-svg-icons'\n\nconst UserInformation = ({ user, isMatch }) => <>\n\n\t<Card.Body>\n\t\t<Card.Title>{user.username}</Card.Title>\n\t\t<Card.Text>{user.firstName} {user.lastName}, {user.age}</Card.Text>\n\t\t{isMatch(user.user_id) && <Card.Text><span className=\"p-1 border border-info rounded text-info\">Match</span></Card.Text>}\n\n\t\t{\n\t\t\tuser.bio\n\t\t\t\t.split('\\n')\n\t\t\t\t.map(p =>\n\t\t\t\t\t<Card.Text key={p}>{p}</Card.Text>\n\t\t\t\t)}\n\n\t</Card.Body>\n\n\t<ListGroup className=\"list-group-flush\">\n\t\t<ListGroupItem>{user.gender} looking for {user.orientation\n\t\t\t.map((o, i) => i === user.orientation.length - 1\n\t\t\t\t? o\n\t\t\t\t: i === user.orientation.length - 2\n\t\t\t\t\t? `${o} and `\n\t\t\t\t\t: `${o}, `\n\t\t\t)}\n\t\t</ListGroupItem>\n\n\t\t{user.tags && <ListGroupItem>\n\t\t\t{user.tags.split('#')\n\t\t\t\t.map((t, i) => i > 1\n\t\t\t\t\t? ` #${t}`\n\t\t\t\t\t: i === 1 ? `#${t}` : null\n\t\t\t\t)}\n\t\t</ListGroupItem>}\n\n\t\t<ListGroupItem>\n\t\t\t{\n\t\t\t\tuser.online\n\t\t\t\t\t? <><FontAwesomeIcon icon={faCircle} color='green' size='xs' /> online</>\n\t\t\t\t\t: <>last online <TimeAgo date={user.last_online} live={false} /></>\n\t\t\t}\n\n\t\t</ListGroupItem>\n\t</ListGroup>\n</>\n\nexport default UserInformation","import React from 'react'\nimport { Modal, Button } from 'react-bootstrap'\nimport { Link } from 'react-router-dom'\n\nconst MatchModal = ({ modal, setModal }) => modal &&\n\t<Modal show={modal !== null} variant=\"success\" onHide={() => setModal(null)} centered>\n\t\t<Modal.Header closeButton>\n\t\t\t<Modal.Title>You got a match!</Modal.Title>\n\t\t</Modal.Header>\n\t\t<Modal.Body>\n\t\t\t<Link to='/matches'>You can now chat with {modal}</Link>\n\t\t</Modal.Body>\n\t\t<Modal.Footer>\n\t\t\t<Button onClick={() => setModal(null)}>Close</Button>\n\t\t</Modal.Footer>\n\t</Modal>\n\nexport default MatchModal","import React from 'react'\nimport { Card } from 'react-bootstrap'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faAward } from '@fortawesome/free-solid-svg-icons'\n\nconst CardHeader = ({ hideUser, fame }) =>\n\t<Card.Body className=\"d-flex justify-content-between\">\n\t\t<span className=\"text-primary cursor-pointer\" onClick={hideUser}>\n\t\t\tBack to the list\n\t\t</span>\n\t\t<span>\n\t\t\t<FontAwesomeIcon icon={faAward} /> {fame}<br />\n\t\t</span>\n\t</Card.Body>\n\nexport default CardHeader","import React from 'react'\nimport { Modal, Button } from 'react-bootstrap'\n\nconst ConfirmationModal = ({ modal: m, setModal }) => {\n\n\treturn m &&\n\t\t<Modal show={m !== null} variant=\"success\" onHide={() => setModal(null)} centered>\n\t\t\t<Modal.Header closeButton>\n\t\t\t\t<Modal.Title>{m.text}</Modal.Title>\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Body>\n\t\t\t\t{m.text} {m.username}?\n\t\t\t</Modal.Body>\n\t\t\t<Modal.Footer>\n\t\t\t\t<Button onClick={() => setModal(null)}>Cancel</Button>\n\t\t\t\t<Button onClick={m.action}>{m.text}</Button>\n\t\t\t</Modal.Footer>\n\t\t</Modal>\n}\nexport default ConfirmationModal","import axios from 'axios'\nimport auth from '../utils/auth'\nconst baseUrl = '/api/report'\n\nconst report = async user_id => {\n\tconst resp = await axios.post(baseUrl, { to_user_id: user_id }, auth.config())\n\treturn resp.data\n}\n\nexport default { report }","import React, { useState, useEffect } from 'react'\nimport { Card } from 'react-bootstrap'\nimport Photos from './Photos'\nimport ActionButtons from './ActionButtons'\nimport UserInformation from './UserInformation'\nimport MatchModal from './MatchModal'\nimport CardHeader from './CardHeader'\nimport ConfirmationModal from './ConfirmationModal'\nimport likeService from '../../../services/likeService'\nimport reportService from '../../../services/reportService'\nimport blockService from '../../../services/blockService'\nimport visitService from '../../../services/visitService'\nimport userService from '../../../services/userService'\nimport socket from '../../../socket'\n\nconst UserCard = ({ user_id, loggedUser, wsClient, hideUser, matches, setMatches, isMatch }) => {\n\n\tconst [liked, setLiked] = useState(false)\n\tconst [matchModal, setMatchModal] = useState(null)\n\tconst [confirmationModal, setConfirmationModal] = useState(null)\n\tconst [userToShow, setUserToShow] = useState(null)\n\n\t//get user if not blocked\n\tuseEffect(() => {\n\t\tblockService\n\t\t\t.getBlockedId(user_id)\n\t\t\t.then(res => {\n\t\t\t\tif (res.length > 0)\n\t\t\t\t\thideUser()\n\t\t\t\telse {\n\t\t\t\t\tuserService\n\t\t\t\t\t.getUser(user_id)\n\t\t\t\t\t.then(res => {\n\t\t\t\t\t\tsetUserToShow(res)\n\t\t\t\t\t})\n\t\t\t\t\t.catch(() => {\n\t\t\t\t\t\thideUser()\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(e => {\n\t\t\t\tconsole.log('Database error', e)\n\t\t\t})\n\t}, [user_id, hideUser])\n\n\t//send notification and save visit\n\tuseEffect(() => {\n\t\tif (userToShow && userToShow.user_id !== loggedUser.user_id) {\n\n\t\t\tsocket.sendNotification(wsClient, {\n\t\t\t\tuser_id: userToShow.user_id,\n\t\t\t\tfrom_id: loggedUser.user_id,\n\t\t\t\tnotification: `${loggedUser.username} viewed your profile`\n\t\t\t})\n\n\t\t\tvisitService\n\t\t\t\t.addVisit({ to_user_id: userToShow.user_id })\n\t\t\t\t.catch(e => {\n\t\t\t\t\tconsole.log('Database error', e)\n\t\t\t\t})\n\t\t}\n\n\t}, [userToShow, loggedUser, wsClient])\n\n\t//get like\n\tuseEffect(() => {\n\t\tif (userToShow)\n\t\t\tlikeService\n\t\t\t\t.getLike(user_id)\n\t\t\t\t.then(res => {\n\t\t\t\t\tif (res.length > 0)\n\t\t\t\t\t\tsetLiked(true)\n\t\t\t\t})\n\t\t\t\t.catch(e => {\n\t\t\t\t\tconsole.log('Database error', e)\n\t\t\t\t})\n\t}, [userToShow, user_id])\n\n\n\tconst sendNotification = notification => {\n\t\tsocket.sendNotification(wsClient, {\n\t\t\tuser_id: user_id,\n\t\t\tfrom_id: loggedUser.user_id,\n\t\t\tnotification\n\t\t})\n\t}\n\n\tconst likeHandler = event => {\n\n\t\tevent.preventDefault()\n\n\t\tlikeService.toggleLike(userToShow.user_id)\n\t\t\t.then(res => {\n\t\t\t\tif (res.value === 1 && res.status === 'match') {\n\t\t\t\t\tsendNotification(`New match with ${loggedUser.username}`)\n\t\t\t\t\tsetMatchModal(userToShow.username)\n\t\t\t\t\tsetMatches(matches.concat({\n\t\t\t\t\t\tuser_id: userToShow.user_id,\n\t\t\t\t\t\tusername: userToShow.username,\n\t\t\t\t\t\tmatch: 1,\n\t\t\t\t\t\tmessages: []\n\t\t\t\t\t}))\n\t\t\t\t}\n\n\t\t\t\telse if (res.value === 1 && res.status === 'like')\n\t\t\t\t\tsendNotification(`${loggedUser.username} likes you`)\n\n\t\t\t\telse if (res.value === 0 && res.status === 'unmatch') {\n\t\t\t\t\tsendNotification(`No longer match with ${loggedUser.username}`)\n\t\t\t\t\tsetMatches(matches.filter(m => m.user_id !== userToShow.user_id))\n\t\t\t\t}\n\n\t\t\t\tsetLiked(res.value)\n\t\t\t})\n\t\t\t.catch(e => {\n\t\t\t\tconsole.log('Database error', e)\n\t\t\t})\n\n\t}\n\n\tconst reportHandler = () => {\n\t\treportService.report(user_id)\n\t\t\t.then(() => setConfirmationModal(null))\n\t\t\t.catch(e => {\n\t\t\t\tconsole.log('Database error', e)\n\t\t\t})\n\t}\n\n\tconst blockHandler = () => {\n\n\t\tif (isMatch)\n\t\t\tsendNotification(`No longer match with ${loggedUser.username}`)\n\n\t\tblockService.block(user_id)\n\t\t\t.then(() => {\n\t\t\t\twindow.location.href = 'http://localhost:3000'\n\t\t\t})\n\t\t\t.catch(e => {\n\t\t\t\tconsole.log('Database error', e)\n\t\t\t})\n\t}\n\n\tconst actionButtonProps = {\n\t\tliked, likeHandler, reportHandler, blockHandler, setConfirmationModal,\n\t\thasPhoto: loggedUser.photos && loggedUser.photos.length > 0,\n\t\tusername: userToShow ? userToShow.username : ''\n\t}\n\n\treturn userToShow\n\t\t? <>\n\t\t\t<Card className=\"w-100 m-auto\">\n\t\t\t\t<CardHeader fame={userToShow.fame} hideUser={hideUser} />\n\t\t\t\t<Photos photos={userToShow.photos} />\n\t\t\t\t<UserInformation user={userToShow} isMatch={isMatch} />\n\t\t\t\t<ActionButtons {...actionButtonProps} />\n\t\t\t</Card>\n\t\t\t<MatchModal modal={matchModal} setModal={setMatchModal} />\n\t\t\t<ConfirmationModal modal={confirmationModal} setModal={setConfirmationModal} />\n\t\t</>\n\t\t: null\n}\n\nexport default UserCard\n","import { useState } from 'react'\n\nexport const useFilter = (name, defVal, type) => {\n\n\tconst [value, setValue] = useState(window.localStorage.getItem(name)\n\t\t? window.localStorage.getItem(name)\n\t\t: defVal)\n\n\tconst handleValue = val => {\n\n\t\tif (type === 'number') {\n\t\t\tval = parseInt(val)\n\n\t\t\tif (!val || val < 0)\n\t\t\t\treturn\n\t\t}\n\n\t\twindow.localStorage.setItem(name, val)\n\t\tsetValue(val)\n\t}\n\n\tconst onChange = e => handleValue(e.target.value)\n\n\treturn { type, value, onChange }\n}","import React from 'react'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faAward } from '@fortawesome/free-solid-svg-icons'\nimport { ListGroup } from 'react-bootstrap'\nimport dbFunctions from '../../utils/dbFunctions'\n\nconst Tags = ({ tags }) => \n\t<div className='text-muted d-inline-block text-truncate w-100'>\n\t\t{\n\t\t\tdbFunctions.userTagsFromDb(tags).map(t => \n\t\t\t\t<span key={t.value} className='tag'>{t.value}</span> \n\t\t\t)\n\t\t}\n\t</div>\n\nconst ListOfUsers = ({ users, handleClick }) => {\n\n\treturn (\n\t\tusers && users.length > 0\n\t\t\t? <ListGroup className=\"text-left mt-3\" variant=\"flush\">\n\t\t\t\t{users.map(u =>\n\t\t\t\t\t<ListGroup.Item action\n\t\t\t\t\t\tclassName='d-flex justify-content-between p-3'\n\t\t\t\t\t\tkey={u.user_id}\n\t\t\t\t\t\tstyle={{ cursor: 'pointer' }}\n\t\t\t\t\t\tonClick={() => handleClick(u)} >\n\n\t\t\t\t\t\t<div className='w-75'>\n\t\t\t\t\t\t\t{u.username}, {u.age.years}<br />\n\t\t\t\t\t\t\t<Tags tags={u.tags} />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className='text-right'>\n\t\t\t\t\t\t\t{parseInt(u.distance)} km<br />\n\t\t\t\t\t\t\t<FontAwesomeIcon icon={faAward} /> {u.fame}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</ListGroup.Item>\n\t\t\t\t)}\n\t\t\t</ListGroup>\n\t\t\t: <div className=\"text-info mt-3\">\n\t\t\t\tCould not find any matching users\n\t\t\t</div>\n\t)\n}\nexport default ListOfUsers","import React, { useCallback, useEffect } from 'react'\nimport { Form } from 'react-bootstrap'\n\nconst SortForm = ({ user, resultsToShow, setResultsToShow }) => {\n\n\tconst sortResults = useCallback((res, by) => {\n\n\t\tconst countMutualTags = tags => {\n\t\t\tconst userTags = user.tags.split('#')\n\n\t\t\treturn tags.split('#').reduce((m, t) => userTags.includes(t)\n\t\t\t\t? m + 1\n\t\t\t\t: m, -1)\n\t\t}\n\n\t\tconst sortByTags = () => res\n\t\t\t.map(r => r.mutualTags\n\t\t\t\t? r\n\t\t\t\t: ({\n\t\t\t\t\t...r,\n\t\t\t\t\tmutualTags: countMutualTags(r.tags)\n\t\t\t\t}))\n\t\t\t.sort((a, b) => b.mutualTags - a.mutualTags)\n\n\t\tif (!res || res.length === 0)\n\t\t\treturn\n\n\t\tlet sortedResults = [...res]\n\n\t\tswitch (by) {\n\t\t\tcase 'age descending':\n\t\t\t\tsortedResults.sort((a, b) => b.age.years - a.age.years)\n\t\t\t\tbreak\n\t\t\tcase 'age ascending':\n\t\t\t\tsortedResults.sort((a, b) => a.age.years - b.age.years)\n\t\t\t\tbreak\n\t\t\tcase 'fame':\n\t\t\t\tsortedResults.sort((a, b) => b.fame - a.fame)\n\t\t\t\tbreak\n\t\t\tcase 'tags':\n\t\t\t\tsortedResults = sortByTags()\n\t\t\t\tbreak\n\t\t\tcase 'distance':\n\t\t\t\tsortedResults.sort((a, b) => a.distance - b.distance)\n\t\t\t\tbreak\n\t\t\tdefault:\n\t\t\t\tbreak\n\t\t}\n\n\t\treturn sortedResults\n\t}, [user.tags])\n\n\tuseEffect(() => {\n\n\t\tconst defaultSortValue = window.localStorage.getItem('matchaSortBy')\n\t\t\t? window.localStorage.getItem('matchaSortBy')\n\t\t\t: 'fame'\n\n\t\tsetResultsToShow(r => sortResults(r, defaultSortValue))\n\n\t}, [setResultsToShow, sortResults])\n\n\t\n\tconst handleSort = e => {\n\t\twindow.localStorage.setItem('matchaSortBy', e.target.value)\n\t\tsetResultsToShow(sortResults(resultsToShow, e.target.value))\n\t}\n\n\treturn <Form>\n\t\t<Form.Group>\n\t\t\t<Form.Label htmlFor='sort-users-field'>Sort by</Form.Label>\n\t\t\t<Form.Control id='sort-users-field' as=\"select\" defaultValue={window.localStorage.getItem('matchaSortBy')\n\t\t\t\t? window.localStorage.getItem('matchaSortBy')\n\t\t\t\t: 'fame'} onChange={handleSort}>\n\t\t\t\t<option value=\"fame\">fame</option>\n\t\t\t\t<option value=\"tags\">mutual tags</option>\n\t\t\t\t<option value=\"age ascending\">age (from youngest to oldest)</option>\n\t\t\t\t<option value=\"age descending\">age (from oldest to youngest)</option>\n\t\t\t\t<option value=\"distance\">distance</option>\n\n\t\t\t</Form.Control>\n\t\t</Form.Group>\n\t</Form>\n}\n\nexport default SortForm","import React from 'react'\nimport { Form, Col } from 'react-bootstrap'\nimport Select from 'react-select'\nimport Togglable from '../../UI/Togglable'\n\nconst FilterForm = ({ user, requiredTags, handleTagsChange, maxDistance, minFame, minAge, maxAge }) => (\n\t<Togglable showText='show filters' hideText='hide filters'>\n\t\t<Form className='mb-3'>\n\t\t\t{user.tags\n\t\t\t\t? <Form.Group>\n\t\t\t\t\t<Form.Label htmlFor='tags-field'>Tags</Form.Label>\n\t\t\t\t\t<Select\n\t\t\t\t\t\tisMulti\n\t\t\t\t\t\tid='tags-field'\n\t\t\t\t\t\tdefaultValue={requiredTags.value}\n\t\t\t\t\t\tvalue={requiredTags.value}\n\t\t\t\t\t\tname='tags'\n\t\t\t\t\t\tonChange={handleTagsChange}\n\t\t\t\t\t\toptions={user.tags\n\t\t\t\t\t\t\t.split('#')\n\t\t\t\t\t\t\t.map(t => t === '' ? ({ value: '', label: '' }) : ({ value: t, label: t }))} />\n\t\t\t\t</Form.Group>\n\t\t\t\t: null\n\t\t\t}\n\n\t\t\t<Form.Row>\n\t\t\t\t<Col>\n\t\t\t\t\t<Form.Group>\n\t\t\t\t\t\t<Form.Label htmlFor='max-distance-field'>Max distance</Form.Label>\n\t\t\t\t\t\t<Form.Control id='max-distance-field' {...maxDistance} />\n\t\t\t\t\t</Form.Group>\n\t\t\t\t</Col>\n\t\t\t\t<Col>\n\t\t\t\t\t<Form.Group>\n\t\t\t\t\t\t<Form.Label htmlFor='min-fame-field'>Min fame</Form.Label>\n\t\t\t\t\t\t<Form.Control id='min-fame-field' {...minFame} />\n\t\t\t\t\t</Form.Group>\n\t\t\t\t</Col>\n\t\t\t</Form.Row>\n\n\t\t\t<Form.Row>\n\t\t\t\t<Col>\n\t\t\t\t\t<Form.Group>\n\t\t\t\t\t\t<Form.Label htmlFor='min-age-field'>Min age</Form.Label>\n\t\t\t\t\t\t<Form.Control id='min-age-field' {...minAge} />\n\t\t\t\t\t</Form.Group>\n\t\t\t\t</Col>\n\t\t\t\t<Col>\n\t\t\t\t\t<Form.Group>\n\t\t\t\t\t\t<Form.Label htmlFor='max-age-field'>Max age</Form.Label>\n\t\t\t\t\t\t<Form.Control id='max-age-field' {...maxAge} />\n\t\t\t\t\t</Form.Group>\n\t\t\t\t</Col>\n\t\t\t</Form.Row>\n\t\t</Form >\n\t</Togglable >\n)\n\nexport default FilterForm","import React, { useEffect, useState } from 'react'\nimport { useFilter } from '../../../hooks/index'\nimport ListOfUsers from '../ListOfUsers'\nimport SortForm from './SortForm'\nimport FilterForm from './FilterForm'\n\nconst UserSearch = ({ user, showUser, users }) => {\n\n\tconst [resultsToShow, setResultsToShow] = useState([])\n\tconst [requiredTags, setRequiredTags] = useState(localStorage.getItem('matchaRequiredTags') || [])\n\n\tconst maxDistance = useFilter('matchaMaxDistance', 100, 'number')\n\tconst minAge = useFilter('matchaMinAge', 20, 'number')\n\tconst maxAge = useFilter('matchaMaxAge', 120, 'number')\n\tconst minFame = useFilter('matchaMinFame', 50, 'number')\n\n\tuseEffect(() => {\n\t\tsetResultsToShow(users)\n\t}, [users])\n\n\tconst handleTagsChange = e => setRequiredTags(e ? e.map(t => t.value) : [])\n\n\tconst requiredTagFound = tags => tags && requiredTags.length > 0\n\t\t? requiredTags.every(t => tags.split('#').includes(t))\n\t\t: true\n\n\tconst matchesFilters = r =>\n\t\tr.distance <= maxDistance.value &&\n\t\tr.age.years >= minAge.value &&\n\t\tr.age.years <= maxAge.value &&\n\t\tr.fame >= minFame.value &&\n\t\trequiredTagFound(r.tags)\n\n\tconst filterResults = () => resultsToShow\n\n\t\t? resultsToShow\n\t\t\t.filter(r => matchesFilters(r))\n\t\t: []\n\n\n\tconst sortFormProps = ({ user, resultsToShow, setResultsToShow })\n\tconst filterFormProps = ({ user, requiredTags, handleTagsChange, maxDistance, minFame, minAge, maxAge })\n\n\treturn <>\n\t\t<SortForm {...sortFormProps} />\n\n\t\t<FilterForm {...filterFormProps} />\n\n\t\t<ListOfUsers users={filterResults()} handleClick={showUser} />\n\t</>\n\n}\n\nexport default UserSearch","import React, { useState, useEffect } from 'react'\nimport likeService from '../../services/likeService'\nimport ListOfUsers from './ListOfUsers'\n\nconst UserLikes = ({ users, showUser }) => {\n\n\tconst [resultsToShow, setResultsToShow] = useState([])\n\n\tuseEffect(() => {\n\t\tlikeService.getLikesToUser()\n\t\t\t.then(res => {\n\t\t\t\tsetResultsToShow(users.filter(u => res.some(l => l.user_id === u.user_id)))\n\t\t\t})\n\t\t\t.catch(e => {\n\t\t\t\tconsole.log('Database error', e)\n\t\t\t})\n\t}, [users, setResultsToShow])\n\n\treturn <>\n\t<div>Users that like you</div>\n\t<ListOfUsers users={resultsToShow} handleClick={showUser} />\n\t</>\n\n}\n\nexport default UserLikes","import React, { useState, useEffect } from 'react'\nimport visitService from '../../services/visitService'\nimport ListOfUsers from './ListOfUsers'\n\nconst UserViews = ({ users, showUser }) => {\n\n\tconst [resultsToShow, setResultsToShow] = useState([])\n\n\tuseEffect(() => {\n\n\t\tvisitService.visitHistory(true)\n\t\t\t.then(res => {\n\t\t\t\tsetResultsToShow(users.filter(u => res.some(v => v.from_user_id === u.user_id)))\n\t\t\t})\n\t\t\t.catch(e => {\n\t\t\t\tconsole.log('Database error', e)\n\t\t\t})\n\t}, [users, setResultsToShow])\n\n\treturn <>\n\t\t<div>Users that viewed you</div>\n\t\t<ListOfUsers users={resultsToShow} handleClick={showUser} />\n\t</>\n\n}\n\nexport default UserViews","import React, { useState, useEffect } from 'react'\nimport { Button, ButtonGroup } from 'react-bootstrap'\nimport { Switch, Route, useRouteMatch, NavLink, useHistory } from 'react-router-dom'\nimport UserCard from './UserCard'\nimport UserSearch from './UserSearch'\nimport UserLikes from './UserLikes'\nimport UserViews from './UserViews'\nimport userService from '../../services/userService'\n\n\nconst UserBrowser = ({ user, wsClient, showUserAtLoad, matches, setMatches }) => {\n\tconst [users, setUsers] = useState([])\n\tconst [userToShow, setUserToShow] = useState(showUserAtLoad)\n\tconst { path, url } = useRouteMatch()\n\tconst history = useHistory()\n\n\tuseEffect(() => {\n\t\tsetUserToShow(showUserAtLoad)\n\t}, [showUserAtLoad])\n\n\tuseEffect(() => {\n\n\t\tuserService\n\t\t\t.getByGenderOrientation(user.orientation, user.gender)\n\t\t\t.then(res => {\n\n\t\t\t\tconst usersFromDb = matches\n\t\t\t\t\t? res.filter(u => !matches.some(m => m.user_id === u.user_id))\n\t\t\t\t\t: res\n\n\t\t\t\tsetUsers(usersFromDb)\n\t\t\t})\n\t\t\t.catch(e => {\n\t\t\t\tconsole.log('Database error', e)\n\t\t\t})\n\t}, [user.gender, user.orientation, user.latitude, user.longitude, matches])\n\n\n\tconst activeLinkStyle = {\n\t\tfontWeight: 'bold'\n\t}\n\n\tconst isMatch = user_id => matches && matches.length > 0\n\t\t? matches.find(m => m.user_id === user_id) !== undefined\n\t\t: false\n\n\tconst hideUser = () => {\n\t\tisMatch(userToShow) ? history.push('/matches') : history.push('/browse')\n\t\tsetUserToShow(null)\n\t}\n\n\tconst showUser = user => setUserToShow(user.user_id)\n\n\tconst userCardProps = {\n\t\tuser_id: userToShow, loggedUser: user, wsClient, hideUser,\n\t\tmatches, setMatches, isMatch\n\t}\n\n\tconst userSearchProps = { user, showUser, users }\n\n\tconst userLikesProps = { showUser, users }\n\n\tconst userViewsProps = { showUser, users }\n\n\treturn matches\n\n\t\t? userToShow\n\n\t\t\t? <UserCard {...userCardProps} />\n\n\t\t\t: <>\n\t\t\t\t<ButtonGroup className=\"mb-5\">\n\t\t\t\t\t<Button variant=\"outline-light\"><NavLink exact to={`${url}`} activeStyle={activeLinkStyle}>All</NavLink></Button>\n\n\t\t\t\t\t<Button variant=\"outline-light\"><NavLink to={`${url}/likes`} activeStyle={activeLinkStyle}>Likes</NavLink></Button>\n\n\t\t\t\t\t<Button variant=\"outline-light\"><NavLink to={`${url}/views`} activeStyle={activeLinkStyle}>Views</NavLink></Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t\t<Switch>\n\t\t\t\t\t<Route exact path={path} render={() => userToShow\n\t\t\t\t\t\t? null\n\t\t\t\t\t\t: <UserSearch {...userSearchProps} />} />\n\t\t\t\t\t<Route path={`${path}/likes`}>\n\t\t\t\t\t\t<UserLikes {...userLikesProps} />\n\t\t\t\t\t</Route>\n\t\t\t\t\t<Route path={`${path}/views`}>\n\t\t\t\t\t\t<UserViews {...userViewsProps} />\n\t\t\t\t\t</Route>\n\t\t\t\t</Switch>\n\t\t\t</>\n\t\t: null\n}\n\nexport default UserBrowser","import React, { useState, useRef, useEffect } from 'react'\nimport { Form, InputGroup } from 'react-bootstrap'\nimport { Card, Modal } from 'react-bootstrap'\n\nconst Chat = ({ user, match, handleClose, wsClient }) => {\n\n\tconst [input, setInput] = useState('')\n\tconst messagesEndRef = useRef(null)\n\tconst inputField = useRef()\n\n\tconst sendMessage = (from, fromUn, to, msg) => {\n\n\t\t//show some kind of error if connection is not working\n\t\tif (wsClient.current.readyState > 1) {\n\t\t\tconsole.log('Could not send message, websocket state', wsClient.current.readyState)\n\t\t\treturn\n\t\t}\n\n\t\twsClient.current.send(JSON.stringify({\n\t\t\ttype: 'message',\n\t\t\tfrom,\n\t\t\tuser: fromUn,\n\t\t\tto,\n\t\t\tmsg\n\t\t}))\n\t}\n\n\tconst handleSubmit = e => {\n\t\te.preventDefault()\n\n\t\tif (!input)\n\t\t\treturn\n\t\tsendMessage(user.user_id, user.username, match.user_id, input)\n\t\tsetInput('')\n\t}\n\n\tuseEffect(() => {\n\t\tif (messagesEndRef.current)\n\t\t\tmessagesEndRef.current.scrollIntoView({ behavior: 'smooth' })\n\t}, [match])\n\n\treturn match\n\t\t? <>\n\t\t\t<Modal show={true} onHide={handleClose} onEntered={() => inputField.current.focus()}>\n\t\t\t\t<Modal.Header closeButton>\n\t\t\t\t\t<Modal.Title>{match.username}</Modal.Title>\n\t\t\t\t</Modal.Header>\n\n\t\t\t\t<Modal.Body className=\"messageContainer\"\n\t\t\t\t\tstyle={{ height: '60vh', overflowY: 'auto', paddingBottom: '5vh' }}>\n\n\t\t\t\t\t{match.messages.map(m =>\n\t\t\t\t\t\t<Card key={m.id} className=\"w-75 mt-2 text-left\"\n\t\t\t\t\t\t\tstyle={{ marginLeft: user.user_id === m.sender ? '25%' : '0' }}>\n\t\t\t\t\t\t\t<Card.Body>{m.msg}</Card.Body>\n\t\t\t\t\t\t</Card>\n\t\t\t\t\t)}\n\n\t\t\t\t\t<div ref={messagesEndRef}></div>\n\n\t\t\t\t</Modal.Body>\n\n\t\t\t\t<Modal.Footer>\n\t\t\t\t\t<Form onSubmit={handleSubmit} className=\"w-100\">\n\t\t\t\t\t\t<InputGroup >\n\t\t\t\t\t\t\t<Form.Control\n\t\t\t\t\t\t\t\tref={inputField}\n\t\t\t\t\t\t\t\tplaceholder={`write a message as ${user.username} and send`}\n\t\t\t\t\t\t\t\tvalue={input}\n\t\t\t\t\t\t\t\tonChange={e => setInput(e.target.value)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<InputGroup.Append>\n\t\t\t\t\t\t\t\t<button className=\"btn btn-primary\" type=\"submit\">send</button>\n\t\t\t\t\t\t\t</InputGroup.Append>\n\t\t\t\t\t\t</InputGroup>\n\t\t\t\t\t</Form>\n\t\t\t\t</Modal.Footer>\n\t\t\t</Modal>\n\t\t</>\n\t\t: null\n}\n\nexport default Chat","import React from 'react'\nimport { ListGroup } from 'react-bootstrap'\nimport { Link } from 'react-router-dom'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faReply, faUser } from '@fortawesome/free-solid-svg-icons'\nimport Chat from './Chat'\n\nconst LatestMsgPreview = ({ messages, user_id }) => {\n\tlet latestReceived = null\n\tlet i = messages.length - 1\n\n\tfor ( ; i >= 0; i-- ) {\n\t\tif (messages[i].receiver === user_id) {\n\t\t\tlatestReceived = messages[i].msg\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tconst replyIcon = () => i === messages.length - 1\n\t\t? ''\n\t\t: <FontAwesomeIcon icon={faReply} color='grey' className='mr-1' />\n\t\n\treturn messages.length > 0 && i !== -1\n\t? <span className='msg-preview d-inline-block text-truncate text-muted'>\n\t\t{replyIcon()} {latestReceived}\n\t</span>\n\t: ''\n}\n\nconst Matches = ({ user, matches, chatToShow, setChatToShow, wsClient }) => {\n\n\n\n\treturn matches && matches.length !== 0\n\t\t? <>\n\t\t\t<ListGroup className='text-left text-primary' variant='flush'>\n\t\t\t\t{matches.map(m =>\n\t\t\t\t\t<ListGroup.Item action key={m.username}\n\t\t\t\t\t\tclassName='d-flex justify-content-between'>\n\t\t\t\t\t\t<div className='w-75 cursor-pointer align-self-center' onClick={() => setChatToShow(m)}>\n\t\t\t\t\t\t\t{m.username}<br/>\n\t\t\t\t\t\t\t<LatestMsgPreview messages={m.messages} user_id={user.user_id} />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<Link to={`browse?user_id=${m.user_id}`} className='p-3 align-self-center chat-profile-link'>\n\t\t\t\t\t\t\t<FontAwesomeIcon icon={faUser} />\t\n\t\t\t\t\t\t</Link> \n\t\t\t\t\t</ListGroup.Item>)\n\t\t\t\t}\n\t\t\t</ListGroup>\n\n\t\t\t<Chat user={user} match={chatToShow} wsClient={wsClient}\n\t\t\t\thandleClose={() => setChatToShow(null)} />\n\t\t</>\n\t\t: <div>Get some matches to chat</div>\n\n}\n\nexport default Matches","import React from 'react'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faCircle } from '@fortawesome/free-solid-svg-icons'\n\nconst Notification = ({ data }) => <>\n\t{data.read ? null : <FontAwesomeIcon icon={faCircle} color=\"gold\" size=\"xs\" className=\"mr-1\" />}\n\t{data.notification}\n</>\n\nexport default Notification","import React from 'react'\nimport { NavDropdown } from 'react-bootstrap'\nimport { Link } from 'react-router-dom'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faBell, faCircle } from '@fortawesome/free-solid-svg-icons'\nimport Notification from './Notification'\n\nconst Notifications = ({ notifications, handleNotificationClick, markAllNotificationsRead }) => {\n\n\tconst notificationsToRender = () => notifications\n\t\t? notifications.slice(0, 8)\n\t\t: []\n\n\tconst unreadNotifications = () => notifications\n\t\t? notifications.find(n => !n.read) !== undefined\n\t\t: false\n\n\tconst dropDownButton = () => <>\n\t\t<FontAwesomeIcon icon={faBell} className='notifications-icon' />\n\t\t{ unreadNotifications()\n\t\t\t? <FontAwesomeIcon icon={faCircle} color='gold' className='unread-notifications-icon' />\n\t\t\t: null\n\t\t}\n\t</>\n\n\treturn notifications\n\t\t? <NavDropdown title={dropDownButton()} id=\"nav-dropdown\" alignRight>\n\t\t\t<NavDropdown.Header>Notifications</NavDropdown.Header>\n\t\t\t{\n\t\t\t\tnotificationsToRender()\n\t\t\t\t\t.map(n => <NavDropdown.Item key={n.id} onClick={() => handleNotificationClick(n)}>\n\t\t\t\t\t\t<Notification data={n} handleClick={handleNotificationClick} />\n\t\t\t\t\t</NavDropdown.Item>)\n\t\t\t}\n\t\t\t<NavDropdown.Divider className='p-0' />\n\t\t\t<NavDropdown.Item as={Link} to='/notifications' className='text-primary'>View all</NavDropdown.Item>\n\t\t\t<NavDropdown.Item onClick={markAllNotificationsRead} className='text-primary'>Mark all as read</NavDropdown.Item>\n\t\t</NavDropdown>\n\t\t: null\n\n}\n\nexport default Notifications","const handleLogout = (wsClient, user_id) => {\n\tlocalStorage.clear()\n\twsClient.current.send(JSON.stringify(({\n\t\ttype: 'close',\n\t\tfrom: user_id\n\t})))\n\twindow.location.href='/login'\n}\n\nexport default { handleLogout }","import React from 'react'\nimport { NavLink } from 'react-router-dom'\nimport { Nav, Navbar } from 'react-bootstrap'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faSignOutAlt, faUser, faComments } from '@fortawesome/free-solid-svg-icons'\nimport { faHeart } from '@fortawesome/free-regular-svg-icons'\nimport Notifications from '../Notifications'\nimport logoutService from '../../services/logoutService'\n\nconst NavigationLink = ({ icon, children, ...props }) =>\n\n\t<Nav.Link as={NavLink} {...props} >\n\t\t{icon ? <FontAwesomeIcon icon={icon} /> : ''} {children}\n\t</Nav.Link>\n\nconst Navigation = (props) => {\n\n\tconst { user, wsClient, userInfoComplete, ...notificationProps } = props\n\n\n\treturn <Navbar className='nav' fixed='top'>\n\n\t\t<Nav id='title'>\n\t\t\t<NavigationLink to='/' title='frontpage' icon={faHeart}>\n\t\t\t\t<span className='hide-on-mobile'> matcha</span>\n\t\t\t</NavigationLink>\n\t\t</Nav>\n\n\t\t{user && user.user_id\n\t\t\t? userInfoComplete(user)\n\t\t\t\t? <Nav>\n\t\t\t\t\t<NavigationLink to='/matches' title='chat' icon={faComments} />\n\n\t\t\t\t\t<NavigationLink to='/profile' title='your profile' icon={faUser} />\n\n\t\t\t\t\t<NavigationLink to=\"/login\" title='logout' onClick={() => logoutService.handleLogout(wsClient, user.user_id)} icon={faSignOutAlt} />\n\n\t\t\t\t\t<Notifications {...notificationProps} />\n\n\t\t\t\t</Nav>\n\t\t\t\t: null\n\n\t\t\t: <Nav>\n\n\t\t\t\t<NavigationLink to='/signup' title='signup'>signup</NavigationLink>\n\n\t\t\t\t<NavigationLink to='/login' title='login'>login</NavigationLink>\n\n\t\t\t</Nav>\n\t\t}\n\n\t</Navbar >\n}\n\nexport default Navigation","import React, { useState } from 'react'\nimport { Form, ResponsiveEmbed, Image } from 'react-bootstrap'\n\n\nconst UploadFirstPhoto = ({ photo, setPhoto }) => {\n\tconst [errorMessage, setErrorMessage] = useState(null)\n\n\tconst handleImageChange = e => {\n\t\te.preventDefault()\n\n\t\tlet reader = new FileReader()\n\t\tlet file = e.target.files[0]\n\n\t\tif (!file)\n\t\t\treturn\n\n\t\tif (file.size > 350000) {\n\t\t\tsetErrorMessage('Max photo size is 350kb')\n\t\t\treturn\n\t\t}\n\n\t\treader.onloadend = () => {\n\t\t\tsetPhoto({ photoStr: reader.result })\n\t\t}\n\t\treader.readAsDataURL(file)\n\t\tsetErrorMessage('')\n\t}\n\n\tconst imagePreview = () => photo && photo.photoStr\n\t\t? <ResponsiveEmbed aspectRatio=\"1by1\" className=\"w-50 m-auto\">\n\t\t\t<div className=\"d-flex\" >\n\t\t\t\t<Image src={photo.photoStr} alt=\"upload preview\" title=\"upload preview\"\n\t\t\t\t\tclassName=\"img-fluid d-block m-auto\" style={{ maxWidth: '100%', maxHeight: '100%' }} />\n\t\t\t</div>\n\t\t</ResponsiveEmbed>\n\t\t: null\n\n\treturn <>\n\t\t<Form className=\"text-center\">\n\t\t\t{imagePreview()}\n\t\t\t{\n\t\t\t\tphoto && photo.profilePic\n\t\t\t\t\t? null\n\t\t\t\t\t: <Form.Group>\n\t\t\t\t\t\t<Form.Label htmlFor=\"photo-upload\" className=\"btn btn-primary mt-3\">Choose photo</Form.Label>\n\t\t\t\t\t\t<Form.Control id=\"photo-upload\" type=\"file\"\n\t\t\t\t\t\t\taccept=\".png, .jpg, .jpeg\" onChange={handleImageChange} className='w-50 m-auto' />\n\t\t\t\t\t</Form.Group>\n\t\t\t}\n\t\t\t{errorMessage && <div className=\"text-center text-danger\" >{errorMessage}</div>}\n\t\t</Form>\n\t</>\n}\n\nexport default UploadFirstPhoto","import React, { useEffect, useState } from 'react'\nimport { useForm } from 'react-hook-form'\nimport { Form, Button } from 'react-bootstrap'\nimport SelectGender from '../../UI/Forms/SelectGender'\nimport SelectOrientation from '../../UI/Forms/SelectOrientation'\nimport SelectTags from '../../UI/Forms/SelectTags'\nimport BioTextArea from '../../UI/Forms/BioTextArea'\nimport UploadFirstPhoto from './UploadFirstPhoto'\nimport userService from '../../../services/userService'\nimport photoService from '../../../services/photoService'\nimport dbFunctions from '../../../utils/dbFunctions'\n\nconst UserInfoForm = ({ user, setUser }) => {\n\n\tconst [photo, setPhoto] = useState({})\n\tconst { register, handleSubmit, errors, control } = useForm()\n\n\tconst [userTagsState, setUserTagsState] = useState({\n\t\tvalue: dbFunctions.userTagsFromDb(user.tags),\n\t\tinputValue: ''\n\t})\n\n\tuseEffect(() => {\n\t\tif (user.photos && user.photos.length > 0)\n\t\t\tsetPhoto(user.photos.find(p => p.profilePic))\n\t}, [user.photos])\n\n\n\tconst onSubmit = data => {\n\n\t\tconst updatedUser = { ...data }\n\t\tupdatedUser.gender = data.gender.value\n\t\tupdatedUser.orientation = dbFunctions.orientationToDb(data.orientation)\n\t\tupdatedUser.tags = userTagsState.value && userTagsState.value.length !== 0\n\t\t\t? userTagsState.value.map(t => t.value).join('')\n\t\t\t: ''\n\n\t\tuserService\n\t\t\t.updateUser(updatedUser, user.user_id)\n\t\t\t.then(data => {\n\n\t\t\t\tif (photo && !photo.profilePic) {\n\n\t\t\t\t\tconst photoToAdd = {\n\t\t\t\t\t\tuser_id: user.user_id,\n\t\t\t\t\t\tprofilePic: 1,\n\t\t\t\t\t\t...photo\n\t\t\t\t\t}\n\n\t\t\t\t\tphotoService\n\t\t\t\t\t\t.addPhoto(photoToAdd)\n\t\t\t\t\t\t.then(addedPhoto => {\n\t\t\t\t\t\t\tconst newUser = { ...user, ...data }\n\n\t\t\t\t\t\t\tnewUser.photos = user.photos\n\t\t\t\t\t\t\t\t? user.photos.concat({ ...photoToAdd, ...addedPhoto })\n\t\t\t\t\t\t\t\t: [{ ...photoToAdd, ...addedPhoto }]\n\n\t\t\t\t\t\t\tsetUser(newUser)\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(e => {\n\t\t\t\t\t\t\tconsole.log('Database error', e)\n\t\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tsetUser({ ...user, ...data })\n\t\t\t})\n\t\t\t.catch(e => {\n\t\t\t\tconsole.log('Database error', e)\n\t\t\t})\n\t}\n\n\treturn <>\n\t\t<div className='text-info text-center mb-3'>Fill your info to start matching!</div>\n\n\t\t<UploadFirstPhoto photo={photo} setPhoto={setPhoto} />\n\n\t\t<Form onSubmit={handleSubmit(onSubmit)} className=\"mt-3\">\n\n\t\t\t<SelectGender gender={user.gender} control={control} errors={errors} />\n\n\t\t\t<SelectOrientation orientation={user.orientation} control={control} errors={errors} />\n\n\t\t\t<SelectTags name='tags' state={userTagsState} setState={setUserTagsState} control={control} errors={errors} />\n\n\t\t\t<BioTextArea bio={user.bio} register={register} errors={errors.bio} />\n\n\t\t\t<Button className=\"mt-3\" type=\"submit\">Update</Button>\n\t\t</Form>\n\t</>\n}\n\nexport default UserInfoForm","import React from 'react'\nimport { ListGroup, Button } from 'react-bootstrap'\nimport Notification from './Notification'\n\nconst NotificationsList = ({ notifications, handleClick, markAllAsRead }) => {\n\n\treturn notifications\n\n\t\t? <>\n\t\t\t<div className=\"text-right mb-3\" >\n\t\t\t\t<Button variant=\"link\" className=\"text-primary\" onClick={markAllAsRead}>\n\t\t\t\t\tMark all as read\n\t\t\t\t</Button>\n\t\t\t</div>\n\t\t\t<ListGroup className=\"text-left cursor-pointer\" variant=\"flush\">\n\t\t\t\t{notifications.map(n =>\n\t\t\t\t\t<ListGroup.Item key={n.id} onClick={() => handleClick(n)} >\n\t\t\t\t\t\t<Notification data={n} />\n\t\t\t\t\t</ListGroup.Item>)\n\t\t\t\t}\n\t\t\t</ListGroup>\n\t\t</>\n\t\t: null\n}\n\nexport default NotificationsList","import React, { useEffect } from 'react'\nimport { useLocation, Switch, Route, Redirect, useHistory } from 'react-router-dom'\nimport { Container } from 'react-bootstrap'\nimport UserProfile from '../UserProfile'\nimport Signup from '../Signup'\nimport Login from '../Login'\nimport Verify from '../Verify'\nimport Forgot from '../ForgotPassword'\nimport Reset from '../ForgotPassword/resetNewPasswd'\nimport UserBrowser from '../UserBrowser'\nimport Matches from '../Matches'\nimport Navigation from './Navigation'\nimport UserInfoForm from './UserInfoForm'\nimport NotificationsList from '../Notifications/NotificationsList'\nimport notificationService from '../../services/notificationService'\n\nconst UserView = ({ user, setUser, matches, setMatches, notifications, setNotifications,\n\tchatToShow, setChatToShow, wsClient }) => {\n\n\tconst history = useHistory()\n\tlet location = useLocation()\n\n\tuseEffect(() => {\n\t\tif (user.user_id) {\n\t\t\tnotificationService\n\t\t\t\t.getNotifications(user.user_id)\n\t\t\t\t.then(res => {\n\t\t\t\t\tsetNotifications(res)\n\t\t\t\t})\n\t\t\t\t.catch(e => {\n\t\t\t\t\tconsole.log('Database error', e)\n\t\t\t\t})\n\t\t}\n\n\t}, [user.user_id, setNotifications])\n\n\tconst userInfoComplete = user => {\n\t\treturn user.firstName && user.lastName && user.username && user.email && user.gender && user.orientation\n\t}\n\n\tconst handleNotificationClick = data => {\n\t\tnotificationService\n\t\t\t.markAsRead(data.id)\n\t\t\t.then(() => {\n\t\t\t\tif (data.notification.endsWith('viewed your profile') ||\n\t\t\t\t\tdata.notification.endsWith('likes you'))\n\t\t\t\t\thistory.push(`browse/?user_id=${data.from_id}`)\n\t\t\t\telse if (data.notification.startsWith('New message from') ||\n\t\t\t\t\tdata.notification.startsWith('New match with') ||\n\t\t\t\t\tdata.notification.startsWith('No longer match with'))\n\t\t\t\t\thistory.push('/matches')\n\t\t\t\tsetNotifications(notifications.map(n => n.id === data.id ? ({ ...n, read: 1 }) : n))\n\n\t\t\t})\n\t}\n\n\tconst markAllNotificationsRead = () => {\n\t\tnotificationService\n\t\t\t.markAllAsRead(user.user_id)\n\t\t\t.then(() => {\n\t\t\t\tsetNotifications(notifications.map(n => ({ ...n, read: 1 })))\n\t\t\t})\n\t\t\t.catch(e => {\n\t\t\t\tconsole.log('Database error', e)\n\t\t\t})\n\t}\n\n\tconst matchProps = {\n\t\tuser, matches, chatToShow, setChatToShow, wsClient\n\t}\n\n\tconst notificationProps = {\n\t\tnotifications, handleNotificationClick, markAllNotificationsRead\n\t}\n\n\tconst navigationProps = {\n\t\tuser, wsClient, userInfoComplete, ...notificationProps\n\t}\n\n\tconst userInfoFormProps = {\n\t\tuser, setUser\n\t}\n\n\treturn <>\n\t\t<Navigation {...navigationProps} />\n\n\t\t<Container id=\"main-container\" fluid=\"lg\">\n\t\t\t<div id=\"middle-column\">\n\t\t\t\t<Switch>\n\t\t\t\t\t<Route exact path=\"/\" render={() => {\n\t\t\t\t\t\treturn user.user_id\n\t\t\t\t\t\t\t? userInfoComplete(user)\n\t\t\t\t\t\t\t\t? <Redirect to=\"/browse\" />\n\t\t\t\t\t\t\t\t: <UserInfoForm {...userInfoFormProps} />\n\t\t\t\t\t\t\t: <Redirect to=\"/login\" />\n\t\t\t\t\t}} />\n\n\t\t\t\t\t<Route path=\"/browse\" render={() => {\n\n\t\t\t\t\t\tconst showUser = location && location.search.indexOf('user_id=') &&\n\t\t\t\t\t\t\tNumber(location.search.substring(location.search.indexOf('user_id=') + 8))\n\n\t\t\t\t\t\t\t? Number(location.search.substring(location.search.indexOf('user_id=') + 8))\n\t\t\t\t\t\t\t: null\n\n\t\t\t\t\t\treturn user.user_id && userInfoComplete(user)\n\t\t\t\t\t\t\t? <UserBrowser user={user} wsClient={wsClient} showUserAtLoad={showUser} matches={matches} setMatches={setMatches} />\n\t\t\t\t\t\t\t: <Redirect to=\"/\" />\n\t\t\t\t\t}} />\n\t\t\t\t\t<Route path=\"/signup\" component={Signup} />\n\t\t\t\t\t<Route path=\"/forgot\" component={Forgot} />\n\t\t\t\t\t<Route path=\"/reset-password/:token\" component={Reset} />\n\t\t\t\t\t<Route path=\"/login\" render={() => user.user_id\n\t\t\t\t\t\t? <Redirect to=\"/\" />\n\t\t\t\t\t\t: <Login setUser={setUser} wsClient={wsClient} />\n\t\t\t\t\t} />\n\t\t\t\t\t<Route path=\"/verify\" render={() => user.user_id\n\t\t\t\t\t\t? <Redirect to=\"/\" />\n\t\t\t\t\t\t: <Verify setUser={setUser} wsClient={wsClient} />\n\t\t\t\t\t} />\n\t\t\t\t\t<Route path=\"/profile\" render={() => user.user_id && userInfoComplete(user)\n\t\t\t\t\t\t? <UserProfile user={user} setUser={setUser} />\n\t\t\t\t\t\t: <Redirect to=\"/\" />\n\t\t\t\t\t} />\n\t\t\t\t\t<Route path=\"/matches\" render={() => user.user_id\n\t\t\t\t\t\t? <Matches {...matchProps} />\n\t\t\t\t\t\t: <Redirect to=\"/\" />\n\t\t\t\t\t} />\n\t\t\t\t\t<Route path=\"/notifications\" render={() => user.user_id\n\t\t\t\t\t\t? <NotificationsList notifications={notifications} handleClick={handleNotificationClick} markAllAsRead={markAllNotificationsRead} />\n\t\t\t\t\t\t: <Redirect to=\"/\" />\n\t\t\t\t\t} />\n\t\t\t\t</Switch>\n\t\t\t</div>\n\t\t</Container>\n\t\t<footer>\n\t\t\t<Container fluid=\"lg\">\n\t\t\t\tlapaset & mhjony 2020\n\t\t\t</Container>\n\t\t</footer>\n\n\t</>\n}\n\n\nexport default UserView","import React, { useState, useEffect, useRef } from 'react'\nimport { BrowserRouter as Router } from 'react-router-dom'\nimport userService from './services/userService'\nimport notificationService from './services/notificationService'\nimport likeService from './services/likeService'\nimport chatService from './services/chatService'\nimport socket from './socket'\nimport auth from './utils/auth'\nimport UserView from './components/UserView'\nimport './style/app.css'\n\nconst App = () => {\n\n\tconst [user, setUser] = useState({})\n\tconst [matches, setMatches] = useState(null)\n\tconst [notifications, setNotifications] = useState(null)\n\tconst [chatToShow, setChatToShow] = useState(null)\n\n\tvar wsClient = useRef({})\n\tconst loadingUser = useRef(true)\n\n\tconst props = {\n\t\tuser, setUser, matches, setMatches, notifications, setNotifications,\n\t\tchatToShow, setChatToShow, wsClient\n\t}\n\n\tuseEffect(() => {\n\t\tconst loggedUserJSON = window.localStorage.getItem('loggedMatchaUser')\n\n\t\tif (loggedUserJSON) {\n\t\t\tconst userFromLocalStorage = JSON.parse(loggedUserJSON)\n\n\t\t\tauth.setToken(userFromLocalStorage.sessionToken)\n\n\t\t\tuserService\n\t\t\t\t.getUser(userFromLocalStorage.user_id)\n\t\t\t\t.then(data => {\n\t\t\t\t\twsClient.current = socket.createWs(userFromLocalStorage.user_id)\n\t\t\t\t\tloadingUser.current = false\n\t\t\t\t\tsetUser(data)\n\t\t\t\t})\n\t\t\t\t.catch(e => {\n\t\t\t\t\tconsole.log('Database error', e)\n\t\t\t\t})\n\n\t\t\treturn () => {\n\t\t\t\twsClient.current.send(JSON.stringify(({\n\t\t\t\t\ttype: 'close',\n\t\t\t\t\tfrom: userFromLocalStorage.user_id\n\t\t\t\t})))\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tloadingUser.current = false\n\t\t\tsetUser({})\n\t\t}\n\t}, [])\n\n\tuseEffect(() => {\n\t\tif (user.user_id) {\n\t\t\tlikeService\n\t\t\t\t.getMatches(user.user_id)\n\t\t\t\t.then(res => {\n\t\t\t\t\tif (res.length < 1) {\n\t\t\t\t\t\tsetMatches([])\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\tconst matchesFromDb = res.map(m => ({\n\t\t\t\t\t\t...m,\n\t\t\t\t\t\tmessages: []\n\t\t\t\t\t}))\n\n\t\t\t\t\tchatService\n\t\t\t\t\t\t.getChatHistory()\n\t\t\t\t\t\t.then(res => {\n\t\t\t\t\t\t\tres.forEach(m => {\n\t\t\t\t\t\t\t\tconst match = matchesFromDb.find(u => u.user_id === m.sender || u.user_id === m.receiver)\n\t\t\t\t\t\t\t\tif (match)\n\t\t\t\t\t\t\t\t\tmatch.messages.push(m)\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\tsetMatches(matchesFromDb)\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(e => {\n\t\t\t\t\t\t\tconsole.log('Database error', e)\n\t\t\t\t\t\t})\n\n\t\t\t\t})\n\t\t\t\t.catch(e => {\n\t\t\t\t\tconsole.log('Database error', e)\n\t\t\t\t})\n\t\t}\n\t}, [user.user_id])\n\n\tuseEffect(() => {\n\n\t\twsClient.current.onmessage = message => {\n\n\t\t\tconst { type, ...dataFromServer } = JSON.parse(message.data)\n\n\t\t\tif (type === 'message' || type === 'rejected') {\n\n\t\t\t\tconst updatedMatches = [...matches]\n\n\t\t\t\tconst match = updatedMatches\n\t\t\t\t\t.find(u => u.user_id === dataFromServer.sender || u.user_id === dataFromServer.receiver)\n\n\t\t\t\tif (!match)\n\t\t\t\t\treturn\n\n\t\t\t\tmatch.messages.push(dataFromServer)\n\n\t\t\t\tif (type === 'message') {\n\t\t\t\t\tif (dataFromServer.receiver === user.user_id && (!chatToShow || chatToShow.user_id !== match.user_id)) {\n\n\t\t\t\t\t\tsocket.sendNotification(wsClient, {\n\t\t\t\t\t\t\tuser_id: user.user_id,\n\t\t\t\t\t\t\tfrom_id: match.user_id,\n\t\t\t\t\t\t\tnotification: `New message from ${match.username}`\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\tsetMatches(updatedMatches)\n\t\t\t\t}\n\n\t\t\t\tif (type === 'rejected' && dataFromServer.sender === user.user_id) {\n\t\t\t\t\tnotificationService\n\t\t\t\t\t\t.notify({\n\t\t\t\t\t\t\tuser_id: dataFromServer.receiver,\n\t\t\t\t\t\t\tfrom_id: dataFromServer.sender,\n\t\t\t\t\t\t\tnotification: `New message from ${user.username}`\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tsetMatches(updatedMatches)\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(e => {\n\t\t\t\t\t\t\tconsole.log('Database error', e)\n\t\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tif (type === 'notification' && notifications) {\n\n\t\t\t\tif (dataFromServer.notification.startsWith('New match with')) {\n\t\t\t\t\tconst newMatch = {\n\t\t\t\t\t\tuser_id: dataFromServer.from_id,\n\t\t\t\t\t\tusername: dataFromServer.notification.slice(15),\n\t\t\t\t\t\tmatch: 1,\n\t\t\t\t\t\tmessages: []\n\t\t\t\t\t}\n\t\t\t\t\tsetMatches(matches.concat(newMatch))\n\t\t\t\t}\n\n\t\t\t\tif (dataFromServer.notification.startsWith('No longer match with'))\n\t\t\t\t\tsetMatches(matches.filter(m => m.user_id !== dataFromServer.from_id))\n\n\t\t\t\tconst updatedNotifications = [...notifications]\n\t\t\t\tupdatedNotifications.unshift({ ...dataFromServer })\n\t\t\t\tsetNotifications(updatedNotifications)\n\t\t\t}\n\t\t}\n\n\t}, [matches, user.user_id, chatToShow, wsClient, notifications, setNotifications, user.username])\n\n\n\treturn loadingUser.current\n\t\t? null\n\t\t: <Router>\n\t\t\t<UserView {...props} />\n\t\t</Router>\n}\n\nexport default App","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(\n\t<App />, document.getElementById('root'))"],"sourceRoot":""}